title: Malware
date: 2018-11-15 11:00
status: draft
tags: malware, vectors, re, debugger
category: research
summary: All things related to malware vector attacks
description: Things that cannot be centralized here
slug: malware

* [Home](http://ithare.com/)
* [On.System Architecture](http://ithare.com/category/system-architecture/)
* [On.Security](http://ithare.com/category/security/)
* [On.Programming](http://ithare.com/category/programming)
* [On Team.Management](http://ithare.com/category/team-management)
* [IT Hare School](http://ithare.com/category/it-hare-school/)
* [IT Jobs in Your Area](http://ithare.com/recent-software-jobs/?q=(programmer+or+developer))

analytics for those Senior Software Developers, Team Leads, Architects,
and Project Managers who're Able to Think

[<img src="Outline%20for%20Chapter%20on%20Bot%20Fighting%20and%20Anti%20Reverse%20Engineering%20-%20IT%20Hare%20on%20Soft.ware_files/BB_weblogo_00011b.png" alt="IT Hare Logo" width="250" height="198" />](http://ithare.com/)

IT Hare
-------

on Soft.ware

<a href="" class="menu-header">Much Ado About Hare</a>
[H.A.R.E. and Bunnylore...](http://ithare.com/hare-and-bunnylore/)

[Real People Behind the
Hare](http://ithare.com/real-people-behind-the-hare/)

[Write for Us](http://ithare.com/write-for-us/)

[Site Announcements](http://ithare.com/category/announcements/)

<a href="" class="menu-header">Book: D&amp;D of MOGs</a>
[Table of
Contents](http://ithare.com/contents-of-development-and-deployment-of-massively-multiplayer-games-from-social-games-to-mmofps-with-stock-exchanges-in-between/)

[1st beta of Vol.
I-III](http://ithare.com/category/dnd-of-mogs-vol1-1st-beta)

[1st beta of Vol.
IV-VI](http://ithare.com/category/dnd-of-mogs-vol2-1st-beta)

[1st beta of Vol.
VII-IX](http://ithare.com/category/dd-of-mogs-part-depl-1st-beta)

Buy Vol. I on
[Amazon](https://www.amazon.com/Development-Deployment-Multiplayer-Online-Games/dp/3903213055/)

Early Access to Vol. I-III on
[Leanpub](https://leanpub.com/b/development-and-deployment-of-multiplayer-online-games-part-arch)



<a href="" class="menu-header">On.System Architecture</a>
[Requirement
Analysis...](http://ithare.com/category/requirements-analysis/)

[Design Decisions...](http://ithare.com/category/design-decisions/)

[Distributed
Systems...](http://ithare.com/category/distributed-systems/)

[(Re)Actors...](http://ithare.com/category/reactors/)

<a href="" class="menu-header">On.Programming</a>
[Tips & Tricks...](http://ithare.com/category/tips-and-tricks/)

[Network
Programming...](http://ithare.com/category/network-programming/)

[Programming
Languages...](http://ithare.com/category/programming-languages/)

[Optimizations...](http://ithare.com/category/optimizations/)

[Debugging...](http://ithare.com/category/debugging/)

[Embedded...](http://ithare.com/category/embedded-development/)



<a href="" class="menu-header">On.Hardware</a>
[MCU](http://ithare.com/category/mcu/)

[Wi-Fi](http://ithare.com/category/wi-fi/)



<a href="" class="menu-header">On.Security</a>
[Best Practices...](http://ithare.com/category/security-best-practices/)

[Fraud Prevention...](http://ithare.com/category/anti-cheating/)

[Research...](http://ithare.com/category/security-research/)



<a href="" class="menu-header">On.Development</a>
[Development
Philosophy...](http://ithare.com/category/development-philosophy/)

[Development
Processes...](http://ithare.com/category/development-processes/)

[Team Structure...](http://ithare.com/category/team-structure/)

[IT Careers & IT Hiring...](http://ithare.com/category/it-careers/)

<a href="" class="menu-header">IT Jobs in Your Area</a>
[Programming
Jobs...](http://ithare.com/recent-software-jobs/?q=(programmer+or+developer))

[Database Jobs...](http://ithare.com/recent-software-jobs/?q=database)

[Information Security
Jobs...](http://ithare.com/recent-software-jobs/?q=%22information+security%22)

[Architect/T-Lead/PM
Jobs...](http://ithare.com/recent-software-jobs/?q=software+(architect+or+%22team+lead%22+or+%22project+manager%22))

<span>Subscribe:</span><a href="http://ithare.com/rssfeed/" class="skew-forward"><img src="Outline%20for%20Chapter%20on%20Bot%20Fighting%20and%20Anti%20Reverse%20Engineering%20-%20IT%20Hare%20on%20Soft.ware_files/socialnet_rss.png" alt="...to RSS feed" width="26" height="26" /></a><a href="http://feedly.com/i/subscription/feed/http://ithare.com/rssfeed/" class="skew-forward"><img src="Outline%20for%20Chapter%20on%20Bot%20Fighting%20and%20Anti%20Reverse%20Engineering%20-%20IT%20Hare%20on%20Soft.ware_files/socialnet_feedly.png" alt="...using Feedly" width="26" height="26" /></a>
Join our mailing list:

<span
id="categorized-tag-cloud-el-1"><a href="http://ithare.com/tag/database/" class="tag-cloud-link tag-link-225 tag-link-position-1">Database</a></span>
<span
id="categorized-tag-cloud-el-2"><a href="http://ithare.com/tag/crazy-stuff/" class="tag-cloud-link tag-link-211 tag-link-position-2">crazy stuff</a></span>
<span
id="categorized-tag-cloud-el-3"><a href="http://ithare.com/tag/multithreading/" class="tag-cloud-link tag-link-4 tag-link-position-3">Multithreading</a></span>
<span
id="categorized-tag-cloud-el-4"><a href="http://ithare.com/tag/cpp/" class="tag-cloud-link tag-link-39 tag-link-position-4">C/C++</a></span>
<span
id="categorized-tag-cloud-el-5"><a href="http://ithare.com/tag/oltp/" class="tag-cloud-link tag-link-226 tag-link-position-5">OLTP</a></span>
<span
id="categorized-tag-cloud-el-6"><a href="http://ithare.com/tag/gcc/" class="tag-cloud-link tag-link-67 tag-link-position-6">GCC/Clang</a></span>
<span
id="categorized-tag-cloud-el-7"><a href="http://ithare.com/tag/client/" class="tag-cloud-link tag-link-132 tag-link-position-7">Client</a></span>
<span
id="categorized-tag-cloud-el-8"><a href="http://ithare.com/tag/scalability/" class="tag-cloud-link tag-link-224 tag-link-position-8">Scalability</a></span>
<span
id="categorized-tag-cloud-el-9"><a href="http://ithare.com/tag/overload/" class="tag-cloud-link tag-link-237 tag-link-position-9">Overload</a></span>
<span
id="categorized-tag-cloud-el-10"><a href="http://ithare.com/tag/server/" class="tag-cloud-link tag-link-134 tag-link-position-10">Server</a></span>
<span
id="categorized-tag-cloud-el-11"><a href="http://ithare.com/tag/determinism/" class="tag-cloud-link tag-link-183 tag-link-position-11">Determinism</a></span>
<span
id="categorized-tag-cloud-el-12"><a href="http://ithare.com/tag/multiplayer/" class="tag-cloud-link tag-link-216 tag-link-position-12">multiplayer</a></span>

Copyright © 2014-2016 ITHare.com

[IT Hare <span class="rabbit-nowrap">on
Soft.ware</span>](http://ithare.com/)

Outline for Chapter on Bot Fighting and Anti Reverse Engineering
================================================================

posted September 25, 2017 by <span style="white-space:nowrap;"><span
class="entry-author" itemprop="author" itemscope="itemscope"
itemtype="http://schema.org/Person"><a href="http://ithare.com/author/nobugs/" class="entry-author-link"><span class="entry-author-name" itemprop="name">&quot;No Bugs&quot; Hare</span></a></span></span>

 
<a href="http://ithare.com/author/nobugs" class="rabbit-author-img-link"><img src="Outline%20for%20Chapter%20on%20Bot%20Fighting%20and%20Anti%20Reverse%20Engineering%20-%20IT%20Hare%20on%20Soft.ware_files/BB_userpic_0013b.png" alt="“No Bugs” Hare" width="120" height="120" /></a>
Author:
**[“No Bugs” Hare](http://ithare.com/author/nobugs)**<span
style="float:right">  Follow: <a href="https://twitter.com/intent/user?screen_name=NoBugsHare" class="skew rabbit-social-link"><img src="Outline%20for%20Chapter%20on%20Bot%20Fighting%20and%20Anti%20Reverse%20Engineering%20-%20IT%20Hare%20on%20Soft.ware_files/socialnet_twitter1.png" alt="Twitter" width="26" height="26" /></a><a href="https://www.facebook.com/pages/No-Bugs-Hare/631718570287515" class="skew rabbit-social-link"><img src="Outline%20for%20Chapter%20on%20Bot%20Fighting%20and%20Anti%20Reverse%20Engineering%20-%20IT%20Hare%20on%20Soft.ware_files/socialnet_facebook.png" alt="Facebook" width="26" height="26" /></a></span>
Job Title:
**Sarcastic Architect**
Hobbies:
**Thinking Aloud**, **Arguing with Managers**, **Annoying HRs**,
**Calling a Spade a Spade**, **Keeping Tongue in Cheek**
 
 
\[rabbit\_ddmog vol=”8″ chap=”Outline of Chapter 29 from “beta” Volume
VIII”\]

As I am [speaking on
CPPCON2017](https://cppcon2017.sched.com/event/67ea13d7e104e12dc49999e8882726b3)
on Friday, I didn’t have time to prepare the next chapter of
“Development and Deployment of Multiplayer Online Games”. Still, I have
a fairly interesting piece of information to share; it is a planned
outline for one of the most controversial chapters in the whole 9
volumes, a chapter on Bot Fighting and Anti Reverse Engineering.

Some time ago, in [one of my previous
posts](http://ithare.com/advocating-obscurity-part-iii-code-obfuscation-basics/),
I have wrote a little bit about obfuscation and anti-reverse engineering
– and was criticised for just scratching the surface of this admittedly
huge subject. Well, it wasn’t the end of my story about reverse
engineering and avoiding it. Here is just an outline for an upcoming
Chapter 29 – I hope it is comprehensive enough this time &lt;wink /&gt;:

Bot Fighting
------------

Sometimes even a hare sets a trap for a wolf.

— L. Solovyov, “Disturber of the Peace, or Hodja Nasreddin in Bokhara” —

-   **Landscape**
    -   Why bot fighting is important for MOGs (refer to Vol. I)
        -   NOT because of piracy (where the case can indeed be lost).
            “Bear in mind that software protection is not economically
            efficient” \[Hacker Disassembling Uncovered by Kris
            Kaspersky, p.117\]
        -   <span
            class="rabbit-pullquote-right-outer rabbit-pullquote-top-p"><img src="Outline%20for%20Chapter%20on%20Bot%20Fighting%20and%20Anti%20Reverse%20Engineering%20-%20IT%20Hare%20on%20Soft.ware_files/BB_emotion_0009b.png" alt="Judging hare:" class="rabbit-pullquote-img rabbit-pullquote-left-right" width="170" height="170" /><span
            class="rabbit-pullquote-right-inner"><span
            class="rabbit-pullquote-quote">“</span>We as MOG developers
            have obligations to protect
            non-cheating players(!)</span></span>We as MOG developers
            have obligations to protect non-cheating players(!)
        -   “Don’t write abusable games“ non-argument. Intersection of
            Turing Test with games =&gt; empty set in practice (FWIW,
            chess and Go are abusable).
        -   “It is hopeless” misperception -&gt; actually, we just fell
            behind in the arms race (more on it below).
        -   It applies ONLY to MOGs – where we DO have Authoritative
            Server. Helps a LOT (in particular – we can disable old
            versions; even with Apple Store, we can get away with
            keeping at-most-2-3-months-back).
    -   Actions
        -   Ban
        -   Red Flag (example actions on red flags: manual review,
            enable captcha, start running deterministic consistency
            tests, etc.)
        -   General: DON’T REVEAL INFO (in particular, how you got him).
            =&gt; Ban Waves
    -   Legal
        -   To ban, we need to have right to ban. Big Company example
            (cannot ban). Another Big Company example (can enforce).
            Refer to Legal Team. ToC. Burden of Proof (!).
        -   TODO: [\[Carpenter\]](#rabbitref-Carpenter),
            [\[Mansoor\]](#rabbitref-Mansoor)
        -   TODO: DMCA
        -   [\[Hogle\]](#rabbitref-Hogle)
        -   [\[Riddle\]](#rabbitref-Riddle)
    -   Most Popular Attacks
        -   In 2001, it was enough to have checksums to cause confusion
            [\[Dodd\]](#rabbitref-Dodd). Now we’re behind, but see
            below…
        -   <span
            class="rabbit-pullquote-right-outer rabbit-pullquote-top-p"><img src="Outline%20for%20Chapter%20on%20Bot%20Fighting%20and%20Anti%20Reverse%20Engineering%20-%20IT%20Hare%20on%20Soft.ware_files/BB_emotion_0007b.png" alt="Assertive hare:" class="rabbit-pullquote-img rabbit-pullquote-left-right" width="170" height="170" /><span
            class="rabbit-pullquote-right-inner"><span
            class="rabbit-pullquote-quote">“</span>Our Adversary: guy
            armed with IDA Pro and debugger</span></span>Our Adversary:
            guy armed with IDA Pro and debugger (IDA, OllyDbg, WinDbg,
            Cheat Engine).
            -   We don’t care about AV guys, or government guys… (we
                still care about AV false positives &lt;sad-face /&gt;)
        -   Most popular attack vectors:
            -   Protocols: openssl.dll (same applies to Win32 API TLS
                calls – TODO).
                -   Any other DLL for that matter.
            -   Data: Windows WM\_GETTEXT.
            -   Texture replacement (to make walls transparent, to make
                opponent more visible, etc.)
            -   Code: IDA
                -   For both “encrypted” and really-encrypted code:
                    dumping+IDA or custom\_loader+IDA
                -   FLIRT(!)
            -   Debugging+patching: disabling protection (naïve video on
                [\[mausy131\]](#rabbitref-mausy131) )
            -   Debugging: Backtracing stack (cannot really hide system
                calls -&gt; finding who has called them)
            -   Debugging: Data analysis: RTTI, VMT pointers
                [\[SabanalYason\]](#rabbitref-SabanalYason)
            -   Protocol-level: Self-MITM
            -   Hooks (see, for example, [\[Aiko\]](#rabbitref-Aiko))
-   **What do we want to achieve**
    -   Security-by-obscurity
        -   “Lost cause” argument (“Then finally, there is that question
            of code privacy. This is a lost cause.”).
            -   Funny: both academic and hacker communities sing it
                in unison. Not funny: companies using it to say “hey,
                technically it doesn’t work, so the only way to handle
                it is legal -&gt; pay us” (ref to GDC talk).
        -   As for “protecting IP”, the cause might indeed be lost, but
            with MOGs and updates in mind – it can be recovered.
            -   Weak point of the “given time, everything can be broken”
                argument: “given time”… B&M example: given time, any
                lock can be broken (but limiting available time to
                “until police comes“ does help quite a bit).
        -   Strategic Goals
            -   Increasing attack costs
                -   Every bit counts! (running faster than bear,
                    cumulative effects; refer to Vol. I)
            -   Multi-layer helps (multiple skill sets, discourage).
            -   <span
                class="rabbit-pullquote-right-outer rabbit-pullquote-top-p"><img src="Outline%20for%20Chapter%20on%20Bot%20Fighting%20and%20Anti%20Reverse%20Engineering%20-%20IT%20Hare%20on%20Soft.ware_files/BB_emotion_0008b.png" alt="Hare pointing out:" class="rabbit-pullquote-img rabbit-pullquote-left-right" width="170" height="170" /><span
                class="rabbit-pullquote-right-inner"><span
                class="rabbit-pullquote-quote">“</span>Economy of hack:
                aiming costs on our side to become &lt;&lt; costs on the
                hacker’s side</span></span>Economy of hack: aiming costs
                on our side to become &lt;&lt; costs on the hacker’s
                side
                -   Changing binaries *cheap-and-often* – attacking
                    “given time” clause
            -   Complicate collaboration between different hackers/teams
                -   Again, changing binaries *cheap-and-often*
            -   Overall – having to break 1000 different obfuscations
                every 2 weeks is an insurmountable task. In theory,
                tools can be developed to deal with it – but as of now,
                such tools don’t exist (not even close); when it happens
                – another round of the arms race. =&gt; We’re back in
                the game!
            -   NOT being identified as malicious etc. (real: Sony
                scandal, perception: “false positive” by some antivirus)
                -   It is heavy system-level stuff which tends to
                    cause trouble. As long as we’re staying within “pure
                    logic” – we’re perfectly fine.
                -   DON’T blindly copy malware-originated techniques
                    (most egregious example is trying to kill
                    AV process)
-   **Protection Philosophy**
    -   Have to use techniques typical both for malicious programs
        (anti-reverse-engineering, polymorphism) and anti-malicious
        (antivirus-like: signature detection, suspicious hook detection,
        rootkit detection etc.) ones
        -   Beware of AV false positives
    -   Weakest-link principle.
        -   Scripting languages on the Client-Side &lt;sad-face /&gt;.
            -   DON’T confuse with a *non-standard* byte-code (which can
                easily be a protection).
    -   Tactical Goals
        -   Difficult to reverse-engineer and disable
            -   No single-point-of-attack
        -   Both code protection *and* data protection
        -   Keeping our source code readable
            -   <span
                class="rabbit-pullquote-right-outer rabbit-pullquote-top-p"><img src="Outline%20for%20Chapter%20on%20Bot%20Fighting%20and%20Anti%20Reverse%20Engineering%20-%20IT%20Hare%20on%20Soft.ware_files/BB_emotion_0040b.png" alt="Hare with " class="rabbit-pullquote-img rabbit-pullquote-left-right" width="170" height="170" /><span
                class="rabbit-pullquote-right-inner"><span
                class="rabbit-pullquote-quote">“</span>ABSOLUTELY NOT
                “Obfuscated C Contest”</span></span>ABSOLUTELY NOT
                “Obfuscated C Contest”
            -   It is *binary* which needs to be obfuscated, not source.
    -   Principles
        -   DON’T reveal info (beyond absolutely necessary)
            -   DON’T enable introspection
        -   DO produce Monolith
            -   DON’T help to split it (not using DLLs follows out of
                it, and also inlining and force-inlining)
        -   Protection MUST *spread over our executable.* One single
            point of protection *doesn’t fly* (too easy to find
            and disable). IsDebuggerPresent() API example.
        -   Frequent completely automated code changes (to “change often
            and cheap”)
        -   Kinda-polymorphic executables
            -   “Compile-time polymorphism”. Very different executables
                even with zero source changes.
            -   Goals: anti-FLIRT, knowledge from hacking previous
                version thrown away, much more difficult collaboration
                between hacking teams.
            -   Danger of differential analysis (mostly theoretical now)
            -   Real (runtime) polymorphism: unclear (where
                modifications should come from? If from binary-level
                algorithmic changes – it is ok, but effort/reward
                is unclear. If from a pre-existing library of equivalent
                pieces of code – has potential to reduce protection –
                however, if Server-driven with real encryption and key
                coming from Server – it *might* fly).
        -   Polymorphic data (~=”the same data looks differently on
            each run”)
            -   At least in theory, can extend to “looks differently
                after each access” (see more on obfuscating
                classes below).
        -   3<sup>rd</sup>-party protection
            -   in theory – any of the below, in practice, most of the
                time – merely code “encryption”
                -   actually – code scrambling, *and* with
                    single-point-of-attack
                -   Also – raise in entropy can lead to false positives
                    by AV [\[Balci\]](#rabbitref-Balci)
            -   con: juicier target (unless exclusive for you). “class
                breaks” [\[Schneier\]](#rabbitref-Schneier), aggravated
                with “as it is security by obscurity, attack is possible
                by definition”. Examples: ScyllaHide/TitanHide
                (see below).
            -   con: usually, source-level information is not used.
            -   <span
                class="rabbit-pullquote-right-outer rabbit-pullquote-top-p"><img src="Outline%20for%20Chapter%20on%20Bot%20Fighting%20and%20Anti%20Reverse%20Engineering%20-%20IT%20Hare%20on%20Soft.ware_files/BB_emotion_0012b.png" alt="Hare thumb up:" class="rabbit-pullquote-img rabbit-pullquote-left-right" width="170" height="170" /><span
                class="rabbit-pullquote-right-inner"><span
                class="rabbit-pullquote-quote">“</span>bot fighting is
                one case when DIY *obviously* rulezzz</span></span>bot
                fighting is one case when DIY *obviously* rulezzz. “Do
                not employ ready-to-use retail protection packages”
                \[Hacker Disassembling Uncovered by Kris Kaspersky,
                p.117\]
            -   Under “every bit counts” principle, 3<sup>rd</sup>-party
                stuff might still be good to use *as a complement to DIY
                source-level obfuscation,* provided that we (a)
                understand what they’re doing, and (b) use those systems
                which indeed provide additional value. Examples:
                -   system-level protection (being-debugged etc.,
                    see below)
                    -   integrity detection/protection
                -   binary-level obfuscation (including “encryption”)
            -   Special Case: VMProtect (there are also sources claiming
                Themida is doing the same thing – but it is unclear
                whether it really does TODO: check)
                -   Usual binary-level obfuscation is still inferior to
                    the source-level one (less information available)
                -   However, virtualizing whole CPU is Damn Interesting™
                    (and hated by hackers too \[Antivirus
                    Hacker’s Handbook\]). Expected to be especially
                    efficient if we combine it with our source-level
                    obfuscation discussed below (different obfuscation –
                    code vs data, different information used
                    to obfuscate). Chances of being flagged by
                    false-positive AV: unclear at the moment.
                -   As such, unlikely to work for *emscripten* – but in
                    general, the “own VM with its own randomized
                    instructions” approach should be
                    generalizable there.
-   **DIY Protection**
    -   Where does a wise man hide a leaf? In the forest.
        But what does he do if there is no forest? He grows a forest to
        hide it in.

        — G.K. Chesterton, The Innocence of Father Brown —

    -   Don’t feed the hacker (MUST do before everything else)
        -   DON’T release Linux/x86 or Linux/x64 version (where the best
            toolset for hacking exists, *and* which is usually not
            interesting monetization-wise). I love Linux but objectively
            – running there increases chances for being attacked
            &lt;sad-face /&gt;.
        -   No DLLs (and no exported symbols)
        -   Anti-FLIRT: Limit the use of standard libraries as much as
            possible
            -   At the very least – recompile them with your own
                compiler settings; *much* better – run it through
                src-2-src compiler (see below) ensuring
                compile-time polymorphism.
            -   Template libraries are usually ok – but it is still
                better to add force-inlining here and there.
        -   No Sensitive Text as Windows Controls
            -   No even DrawText etc.
                -   =&gt; owner-draw everything (and not only
                    on Windows)
            -   <span
                class="rabbit-pullquote-right-outer rabbit-pullquote-top-p"><img src="Outline%20for%20Chapter%20on%20Bot%20Fighting%20and%20Anti%20Reverse%20Engineering%20-%20IT%20Hare%20on%20Soft.ware_files/BB_emotion_0019b.png" alt="Assertive hare:" class="rabbit-pullquote-img rabbit-pullquote-left-right" width="170" height="170" /><span
                class="rabbit-pullquote-right-inner"><span
                class="rabbit-pullquote-quote">“</span>Encrypt your
                traffic (otherwise –
                self-MITM attack)</span></span>Encrypt your traffic
                (otherwise – self-MITM attack)
            -   Minimize OS calls (can’t be really hidden =&gt; give
                away information). What do we really need? Usually –
                *only* (a) inputs, (b) graphics, (c) network, (d) file
                reads/writes, that’s it(!). Anything else is just
                feeding the hacker (and now check dependencies of
                your .EXE).
    -   Bot/modification Detection
        -   What we need to deal with? If grinding bots -&gt; may want
            to Captcha
        -   Client-Side detection
            -   System-level, see below
            -   Honey pots, see below
    -   Server-Side Statistics detection (TODO: elaborate!)
    -   Player Complaints -&gt; tools 4 security team
    -   System-level protection
        -   Using some-information-which-is-external-to-code (mostly
            system calls)
        -   For our purposes – Windows & emscripten (very few
            system-level protections applicable for emscripten
            &lt;sad-face /&gt;)
        -   Time-Based Protections (delays) – one of the very few
            somewhat-cross-platform protections
            -   Aims:
                -   Detecting debugger; nonblocking\_code&lt;&gt;, using
                    obfuscation techniques
                    for (end-start)&gt;MAX\_DELAY. Account for context
                    switches! For RDTSC – also check for
                    normally-impossible (end-start)==0.
                -   potential to detect VMs
            -   <span
                class="rabbit-pullquote-right-outer rabbit-pullquote-top-p"><img src="Outline%20for%20Chapter%20on%20Bot%20Fighting%20and%20Anti%20Reverse%20Engineering%20-%20IT%20Hare%20on%20Soft.ware_files/BB_emotion_0024b.png" alt="Hare asking question:" class="rabbit-pullquote-img rabbit-pullquote-left-right" width="170" height="170" /><span
                class="rabbit-pullquote-right-inner"><span
                class="rabbit-pullquote-quote">“</span>GetTickCount(),
                also via SharedUserData (0x7FFE000)</span></span>Tricks:
                RDTSC, QueryPerformanceTimer(), GetTickCount(), the
                latter also via SharedUserData (0x7FFE000); coherency
                between the two (otherwise – kernel debugger or
                Scylla present). TODO: timeGetTime()
                -   measure relative speeds “normally” and around
                    exceptions [\[Falliere\]](#rabbitref-Falliere)
                -   RDTSC: combine with function integrity checks.
                -   Obfuscating RDTSC [\[pedram\]](#rabbitref-pedram) –
                    *really* weird and risky, but is still interesting…
                -   emscripten\_get\_now(), EM\_ASM and calling JS
                    performance.now or Date().getTime() directly. NB:
                    danger of JS being interrupted when hidden – and iOS
                    seems to exhibit this behavior; on desktops it does
                    seem to work now, but see
                    [\[Antony@StackOverflow\]](#rabbitref-Antony@StackOverflow)
            -   Avoid direct checks – just use result for obfuscator
                instead… (such as adding/xoring (end-start)/MAX\_DELAY,
                varying MAX\_DELAY a bit to add variability).
        -   Executable integrity (checksum etc.)
            -   Function-level checksum
                [\[Kulchytskyy\]](#rabbitref-Kulchytskyy) TODO:
                calculation of checksums
            -   Avoid direct checks – mix into obfuscation instead…
            -   Multi-level checksums (Skype,
                [\[BiondiDesclaux\]](#rabbitref-BiondiDesclaux))
            -   TODO: emscripten
        -   Debugger Detection/Prevention
            -   [\[Ferrie\]](#rabbitref-Ferrie), some source in
                [\[LordNoteworthy@github\]](#rabbitref-LordNoteworthy@github).
                Most common/interesting ones:
            -   IsDebuggerPresent(), CheckRemoteDebuggerPresent() etc.
                (quite silly, mostly as a kinda-decoy)
                -   OS calls are *not* 100% obfuscatable =&gt; using
                    them (unless they’re actually inlines or macros) is
                    a Bad Idea™ (Bad Example:
                    [\[zer0fl4g@github\]](#rabbitref-zer0fl4g@github)).
                    IF using them – obfuscate system calls
                    *and *literals (such as obfuscating “OllyDbg” for
                    FindWindow(), and obfuscating “FindWindow” for
                    GetProcAddress()); more on obfuscating system calls
                    below
            -   Not-so-obvious system calls, such as
                OpenProcess(“csrss.exe”),
                OutputDebugString(), UnhandledExceptionFilter()
            -   FindWindow() (silly, but…)
            -   Memory reads. NtGlobalFlag, heap flags,
                KdDebuggerEnabled, GetLastError() (cmp fs:\[ebp+34h\],
                ebp, cmp gs:\[rbp+68h\], ebp), TODO – anything else?
                Reading from RAM without function call(!).
                -   DON’T use directly for comparisons; instead – use as
                    a part of data obfuscation (in particular, will look
                    similar to ‘global read of known value’ used to
                    prevent optimizing out). Effective partial compares
                    when using for data obfuscation (using &mask1 in one
                    place, |mask2 in another place).
                -   More devious: use the value to generate decryption
                    key, then try to decrypt several pieces of code
                    (with one decrypted by “correct” key, and another by
                    “being-debugged” key, other combinations of
                    “being-debugged” flags also can be accounted for).
                    Then use this code to communicate to the server –
                    which now can distinguish clients which are being
                    debugged (gotcha!).
                -   <span
                    class="rabbit-pullquote-right-outer rabbit-pullquote-top-p"><img src="Outline%20for%20Chapter%20on%20Bot%20Fighting%20and%20Anti%20Reverse%20Engineering%20-%20IT%20Hare%20on%20Soft.ware_files/BB_emotion_0025b.png" alt="Hare wondering if you are crazy:" class="rabbit-pullquote-img rabbit-pullquote-left-right" width="170" height="170" /><span
                    class="rabbit-pullquote-right-inner"><span
                    class="rabbit-pullquote-quote">“</span>Even more
                    devious: use the value to generate encryption key,
                    which is used to encrypt a well-defined constant,
                    which is sent to the server – which then can try
                    different keys to
                    decrypt (gotcha!)</span></span>Even more devious:
                    use the value to generate encryption key, which is
                    used to encrypt a well-defined constant, which is
                    sent to the server – which then can try different
                    keys to decrypt (gotcha!)
            -   “self-debug” (actually – debug a copy of the process).
                Only one ring 3 debugger allowed at least in Windows.
            -   Hiding thread from debugger: NtSetInformationThread,
                NtCreateThreadEx (reportedly used by Steam at least at
                some point)
            -   MOV SS
            -   INT 2D
            -   “check within TLS callback” trick
            -   NB: using Zw\* counterparts \[TODO – elaborate\]
            -   Messing with debuggers:
                -   BlockInput; not really detection, but…
                -   REP &lt;some-op&gt;
            -   [\[Kulchytskyy\]](#rabbitref-Kulchytskyy) Most
                interesting techniques (beyond
                [\[Ferrie\]](#rabbitref-Ferrie))
                -   NtCreateThreadEx to hide threads
                -   Asm to set SEH handlers (32-bit only); on
                    table-based SEH in x64 Windows – see
                    [\[NTInsider\]](#rabbitref-NTInsider)
                -   KiUserExceptionDispatcher
            -   [\[Falliere\]](#rabbitref-Falliere).Techniques going
                beyond previous refs:
                -   PUSH SS/POP SS (actually, it is described in
                    [\[Ferrie\]](#rabbitref-Ferrie), but IMO explanation
                    here is better)
                -   ICE breakpoint (0xF1); not to be confused
                    with SoftICE.
                -   Scanning for INT 3 (0xCC). False positives. Also
                    should scan for 0xFA
                    [\[Falliere\]](#rabbitref-Falliere) and
                    probably others. Checksums are generally preferred.
            -   [\[OpenRCE\]](#rabbitref-OpenRCE) Techniques going
                beyond previous refs:
                -   LOCK CMPXCHG8B as an invalid instruction to raise
                    SEH
                -   Lots of debugger-specific trickery
            -   [\[Tully\]](#rabbitref-Tully). Techniques going beyond
                previous refs:
                -   Removing PE Header
                -   Messing with debuggers:
                    -   OutputDebugString Exploit for OllyDbg (TODO: is
                        it still up-to-date?)
            -   SoftICE detection (doesn’t make much sense now, esp. if
                your program is 64-bit, but some ideas *might *be
                applicable to other debuggers): lots of discussion in
                \[Crackproof your software\]
            -   – May be there’s still hope?
                - Nope

                — Garfield the Cat —

                ScyllaHide
                [\[nihilus@github\]](#rabbitref-nihilus@github),
                TitanHide
                [\[mrexodia@github\]](#rabbitref-mrexodia@github) Very
                good examples of “class break”. Still MIGHT want to do
                anti-debug but don’t overplay it (and more importantly –
                don’t overrely on it). Candidates to bypass: reading
                TickCount directly from RAM, RDTSC \[\[TODO: something
                else?\]\]

        -   Obfuscating system calls:
            -   Not really possible, but we should still try as much as
                we can (beware of triggering AVs though).
                -   AV false positives: selective obfuscation (such as
                    Internet/sockets), see on false positives below
            -   LoadLibrary()+GetProcAddress() with all the literals
                being obfuscated(!).
            -   *At least* – should obfuscate everything (except
                for LoadLibrary() and GetProcAddress()), at the *very*
                least – obfuscate all the socket calls (traditionally,
                they’re one of the very primary targets for MOTs) *TODO:
                analysis for using MSVCRT’s socket wrappers
                over WS2\_32.*
            -   See [\[Wardman\]](#rabbitref-Wardman) – still imperfect,
                but not *that* obvious (especially if combined with
                obfuscating literals etc.)…
            -   Using custom DLL loader (such as
                [\[pasztorpisti@codeproject\]](#rabbitref-pasztorpisti@codeproject))
                for system DLLs – unlikely &lt;sad-face /&gt; (still,
                *might* be worth trying). Any ideas on improving the
                loader are *very *appreciated
            -   emscripten: EM\_ASM(eval()), self-modifying code
                [\[Elliot\]](#rabbitref-Elliot)
        -   Avoiding emulators – see Chapter 8 in \[Antivirus Hacker’s
            Handbook\]
            -   the main idea is to run in a sandbox and see any changes
                in the environment. [\[F-Secure\]](#rabbitref-F-Secure):
                “When execution stops, the sandbox is analysed
                for changes.”. MAY be misused by attackers…
            -   core count [\[Balci\]](#rabbitref-Balci) – questionable
                (can cause false positives)
            -   not that big deal (we are NOT malicious, so the sandbox
                won’t change(!))
        -   “encryption” (actually, scrambling):
            -   probably the best one: HARES
                [\[Torrey\]](#rabbitref-Torrey). No relation to ‘IT
                Hare’ ;-).
                -   Hypervisor (thin, but still &lt;ouch! /&gt;)
                -   TLB split (clever but x64-only…)
                -   Still single-point-of-attack
            -   Guard pages [\[Tully\]](#rabbitref-Tully), simple
                on-demand code descrambling.
            -   “Stolen bytes” [\[Tully\]](#rabbitref-Tully) – not much
                effect, really.
        -   DLL injection detection/prevention.
            -   Process debugs itself (actually – a copy of itself)
            -   TLS hook
            -   Thread count &lt;smile /&gt;.
            -   TODO: dealing with “reflective DLL injection”
        -   VM detection, Sandbox detection, WINE detection
            -   [\[Cannell\]](#rabbitref-Cannell)
            -   [\[Wójcik\]](#rabbitref-Wójcik)
            -   drivers
        -   Hacking PE files
            -   SizeOfImage [\[Tully\]](#rabbitref-Tully)
            -   messing with PE sections
                [\[MachinesCanThink\]](#rabbitref-MachinesCanThink)
            -   Several things for Linux [\[Baines\]](#rabbitref-Baines)
            -   Beware: obvious and highly suspicious for AVs
        -   Known-Bad-for-Us Processes
            -   Legality claims – IMO unlikely, but check with legal
            -   Antivirus-like analysis/techniques
        -   Implementation: In-process -&gt; separate process (bad)
            -&gt; service -&gt; driver (questionable) -&gt; rootkit (Big
            No-No, refer to “Sony rootkit scandal”)
            -   Usually – Single Point of Attack
            -   Obfuscate Communications (see below)
    -   Data obfuscation basics
        -   Only theory for the time being (practicalities will be
            discussed later)
        -   Obfuscation: DEOBF(OBF(X)) === X
        -   Obfuscation Generators (!) – same as “Pocket Generators”
            from [\[Hare.1\]](#rabbitref-Hare.1)  –
            [\[Hare.3\]](#rabbitref-Hare.3)
            -   *Automatically generated from true random number on
                each build(!!)*
            -   <span
                class="rabbit-pullquote-right-outer rabbit-pullquote-top-p"><img src="Outline%20for%20Chapter%20on%20Bot%20Fighting%20and%20Anti%20Reverse%20Engineering%20-%20IT%20Hare%20on%20Soft.ware_files/BB_emotion_0041b.png" alt="Hare with smiley sign:" class="rabbit-pullquote-img rabbit-pullquote-left-right" width="170" height="170" /><span
                class="rabbit-pullquote-right-inner"><span
                class="rabbit-pullquote-quote">“</span>Obfuscation
                Generators cover the spectrum from simple XOR to
                “White-Box Encryption”</span></span>Generalization of
                “White-Box Encryption”
                [\[Whiteboxcrypto\]](#rabbitref-Whiteboxcrypto); cover
                the spectrum from XOR to “White-Box Encryption”
                -   Advantages of Generators: (a) can be made much more
                    lightweight and inlinable than “White-Box
                    Encryption” (!), (b) allows for MUCH wider variety
                    of algorithms (actually *any* bijection will
                    do), (c) increase space for potential algos
                    multiple-fold, (d) =&gt; cannot be found via
                    techniques such as [\[XuEtAl\]](#rabbitref-XuEtAl),
                    [\[LestringantEtAl\]](#rabbitref-LestringantEtAl),
                    and [\[Calvet\]](#rabbitref-Calvet)
                    -   In many cases can avoid “crypto loop”
                        entirely (!).
        -   Primitives, and more primitives:
            -   Bijections
            -   Injections (increase size but are still reversible). No
                relation to “DLL injection”
            -   Examples:
                -   XOR, ADD mod 2^n
                    -   XOR MAY be undesirable due to false AV positives
                        [\[RaabeBallenthin\]](#rabbitref-RaabeBallenthin)
                -   Bit-wise rotations
                -   Bit-wise shift followed by XOR-with-original
                -   Permutations (swapping bytes or even bits); AES
                    permutations as one example.
                -   \*c mod 2^n where c is odd
                -   Galois arithmetic (a.k.a. ”finite field arithmetic”)
                    -   Both addition and multiplication are reversible
                    -   GF(p), where p&gt;2^n. First operation
                        effectively converts from 2^n space into p
                        space, so it is injection – increases size! In
                        exchange, reverse operation provides
                        kinda-checksum (which can be used to detect
                        strange things happening)
                        -   <span
                            class="rabbit-pullquote-right-outer rabbit-pullquote-top-p"><img src="Outline%20for%20Chapter%20on%20Bot%20Fighting%20and%20Anti%20Reverse%20Engineering%20-%20IT%20Hare%20on%20Soft.ware_files/BB_emotion_0035b.png" alt="Hare wearing dunce cap:" class="rabbit-pullquote-img rabbit-pullquote-left-right" width="170" height="170" /><span
                            class="rabbit-pullquote-right-inner"><span
                            class="rabbit-pullquote-quote">“</span>GF(p)
                            where p is a pseudo+Mersenne
                            number</span></span>Where p is
                            pseudo+Mersenne (speeds things up; see
                            [\[IvanchykhinEtAl\]](#rabbitref-IvanchykhinEtAl)
                            for details)
                    -   GF(2^n) field. Bijections all the way.
                        Multiplication (example: S-box;
                        table-based reverse).
                        -   Two representations: ‘normal’
                            and ‘polynomial’. Not sure whether a
                            reasonably fast conversion exists between
                            the two &lt;sad-face /&gt; (I should get out
                            of my depths *somewhere* &lt;wink /&gt;)
                    -   GF(p^n) field, where p!=2 (example: GF(3^n))
                -   PRNGs:
                    -   Mostly for streams (for ints etc. – see
                        Fenstel below).
                    -   Salt!
                    -   From LCG and LFSR (better to make sure to
                        generate constants to ensure maximum period)
                        to CPRNG. Can use one-way functions within.
                        -   One-way: can use floating-point math for
                            intra-executable obfuscation
                            -   Determinism required: beware runtime
                                floating-point settings (see
                                [\[Dawson\]](#rabbitref-Dawson)
                                for details). Relief: for intra-Client,
                                we’re speaking about “same-executable
                                determinism”
                            -   Mix with integer ops
                            -   Do use
                                the-same-stuff-you’re-using-for-3D
                                graphics (sin(), cos() – *the same
                                versions as you use for 3D!)*
                            -   SSE
                        -   LFSR and pseudo-block-cipher-in-CTR-mode
                            – O(1) calculation of arbitrary point
                            in stream.
                        -   Mixing function: not only XOR (actually –
                            most of obfuscation primitives)
                    -   Approximate float-point calculations
                        -   “Smooth” functions (actually – limited
                            1<sup>st</sup> derivative). Example – sin().
                            Avoid too-low or too-high 1<sup>st</sup>
                            derivative values (good example – (-1,1)
                            range for sin()). Potentially – uneven
                            distribution of inputs to compensate.
                            -   Sin() – similarities to CORDIC
                                [\[Bertrand\]](#rabbitref-Bertrand)
                            -   Function-specific obfuscation (example
                                for sin(): add alpha on OBF, add
                                2\*pi-alpha on DEOBF; example2 for
                                sin(): add alpha on OBF, add pi-alpha,
                                and then negate on DEOBF).
                            -   Compound (examples:
                                sin(sh(x)), sin(sin(x)))
                        -   Using different libs for OBF/DEOBF (such as
                            your-usual-library on OBF, Taylor
                            approximation-or- on DEOBF).
                            -   Approximations: Taylor, Chebyshev,
                                polynomial [\[Chou\]](#rabbitref-Chou),
                                [\[zfedoran@stackoverflow\]](#rabbitref-zfedoran@stackoverflow)
                            -   Specific sin() approximations: Bhaskara
                                I, CORDIC, integer
                                [\[porgarmingduod@stackoverflow\]](#rabbitref-porgarmingduod@stackoverflow)
                        -   Conversion into approximated 3D space, using
                            reversible operations in that space such as
                            movements, rotations etc. (rotations, in
                            turn, will use matrices&quaternions). Fun
                            stuff, but it is difficult to control
                            reversibility when multiple approximate
                            operations are involved &lt;sad-face /&gt;.
                    -   Crypto-primitives:
                        -   <span
                            class="rabbit-pullquote-right-outer rabbit-pullquote-top-p"><img src="Outline%20for%20Chapter%20on%20Bot%20Fighting%20and%20Anti%20Reverse%20Engineering%20-%20IT%20Hare%20on%20Soft.ware_files/BB_emotion_0006b.png" alt="Surprised hare:" class="rabbit-pullquote-img rabbit-pullquote-left-right" width="170" height="170" /><span
                            class="rabbit-pullquote-right-inner"><span
                            class="rabbit-pullquote-quote">“</span>Fenstel
                            round: allows to use one-way functions
                            </span></span>Fenstel round: allows to use
                            one-way functions (somewhat-similar to PRNG,
                            but more suitable for fixed-size data).
                        -   S-Box (actually – a specific case
                            of GF(2^n))
                        -   RSA-like encryption+decryption (we can use
                            MUCH smaller sizes, like 64-bit or even
                            16-bit &lt;wink /&gt;)
                        -   Discrete logarithm (like using half of
                            Diffie-Hellman key exchange with g^a mod p
                            being pre-shared). Can use MUCH smaller
                            sizes, like 64-bit
                        -   TODO: more
                        -   Any crypto (including broken crypto such as
                            TEA and reduced-rounds crypto)
                    -   LOTS of other stuff should exist too &lt;smile
                        /&gt;
                -   Making reverse code difficult-to-find
                    -   Using the same constant in several
                        unrelated places. Using system-wide constants
                        (such as 0x7FFE000) instead of random
                        ones liberally.
                    -   Trivial example: composite
                        additions/multiplications (beware of smart
                        compiler optimizing it out! – see below)
                    -   Less-trivial-example: ADD constant as 3 smaller
                        ADDs combined via bitshifts etc. (if elaborated
                        enough – very little risk of compiler optimizing
                        it out). Generalization – any multiple-precision
                        calc from Knuth Vol. 2 (and not necessarily
                        along word lines(!)).
                    -   Relying on trivial math such as ~x === -x-1,
                        x &gt;&gt; 4 === x / 16, x / 5 === x \*
                        0xCCCCCCCCCCCCCCCD (as long as x is uint64\_t)
                        and so on. Beware: modern compilers usually know
                        it too and optimize less-optimal-one (but if we
                        throw in volatile or external var – things
                        will change).
                    -   Using floats to calculate integer
                        stuff (asm.js-style)
                        -   Integer SSE
                    -   Using alternative representations:
                        -   Built-in types or boost::multiprecision
                            (beware: the latter can happen to be
                            sssslllooowww compared to math-based
                            alternatives such as Montgomery
                            or pseudo+Mersenne)
                        -   Montgomery representation for GF(p). (both
                            modular addition and multiplication are ok
                            in Montgomery)
                        -   Modular representation. Use Chinese
                            remainder theorem to produce “modular
                            representation” as a pair of remainders
                            given co-primes A and B, where
                            A\*B&gt;2^n (injection!). Reverse
                            conversion: use extended Euclidean algorithm
                            to get Bezout coefficients and restore the
                            value back. Addition/multiplication in
                            “modular representation” are trivial (see
                            Knuth Vol. 2 on Modular Arithmetic).
                        -   For GF(p), GF(p^n) – using redundant
                            “partially normalized” representations
                            [\[IvanchykhinEtAl\]](#rabbitref-IvanchykhinEtAl) –
                            especially good for accumulations.
                        -   For GF(p) where p is pseudo+Mersenne – using
                            special properties of pseudo+Mersenne
                    -   Different ways to calculate exponent: linear, by
                        squaring, using Montgomery.
                    -   All constants can be further obfuscated too
                        (beware of compilers optimizing
                        obfuscation out(!))
                    -   Universal difficult-to-reverse over 8 bits or
                        so: some math one way, table another way.
                    -   multithreaded obfuscation
                        (still deterministic(!))
                        -   busy loops (don’t forget about
                            memory barriers(!) – or just wait long
                            enough &lt;wink /&gt;)
                            -   nice interaction with avoiding
                                optimizing out – *volatile*
                            -   end not by flag, but by some checksum
                                within result being valid (128 bit of a
                                *good *checksum is enough)
                            -   not so busy loops (sleep(),
                                SwitchToThread(), etc.)
                            -   Win32 Events, C++ cond\_vars
                    -   Even more other stuff should exist too &lt;smile
                        /&gt;
                -   Generated obfuscation should NOT be a part of the
                    regular source code tree(!) (important to
                    avoid leaks-of-everything-at-once)
                -   Mixing in external data (such as “being debugged” in
                    memory, which is supposed to be always-0) – plays
                    well with external vars &lt;smile /&gt;
                -   for non-MOGs: in theory, can be used to identify
                    leaks (generated stuff is a “fingerprint” for
                    the Client)
    -   Obfuscating at source code level
        -   Difference between programming languages
            -   <span
                class="rabbit-pullquote-right-outer rabbit-pullquote-top-p"><img src="Outline%20for%20Chapter%20on%20Bot%20Fighting%20and%20Anti%20Reverse%20Engineering%20-%20IT%20Hare%20on%20Soft.ware_files/BB_emotion_0022b.png" alt="Surprised hare:" class="rabbit-pullquote-img rabbit-pullquote-left-right" width="170" height="170" /><span
                class="rabbit-pullquote-right-inner"><span
                class="rabbit-pullquote-quote">“</span>Obfuscation-wise,
                C++ rulezzzz</span></span>Table from Vol. II’s chapter
                on Client-Side Architecture. Obfuscation-wise,
                C++ rulezzzz.
            -   We’ll discuss C++, though *some* of the findings will
                apply across the board
        -   C++ source-level protection (this is what we’ll actually
            speak about &lt;wink /&gt;)
            -   Applicable to *any* C++, including *emscripten* (a bit
                less protected, but still…)
            -   JS/Java-style obfuscation is *useless* for C/C++
                -   Except for class names in RTTI, but we should
                    disable RTTI anyway
            -   Remove Dbg info
            -   Compiler options (high optimization levels, *maybe*
                unroll loops)
            -   On avoiding to optimize out (for some of obfuscations,
                especially literal obfuscations, to work):
                -   volatile (see
                    [\[Epp@stackoverflow\]](#rabbitref-Epp@stackoverflow) ,
                    [\[Keil\]](#rabbitref-Keil), and
                    [\[Regehr\]](#rabbitref-Regehr) ); seems to apply to
                    Java but not to other languages
                -   ‘xor with a global non-static var which happens to
                    be always-zero’ (also *seems* to apply
                    to Java/JS/…).
                -   system call with a predefined result (like reading
                    some bytes from your own file which never changes);
                    also applies to Java/JS/…
                -   | (x+1==x) and other impossible math (not really
                    reliable in the long run, especially for
                    obfuscating literals)
                -   Asm:
                    -   Empty asm [\[jrmymllr\]](#rabbitref-jrmymllr)
                    -   Generated asm
                        -   “normal” GCC-style-with-constraints asm with
                            intermediate registers etc.
                            -   DO allow compiler to choose registers
                                &lt;evil-grin /&gt;
                            -   does it work for Clang/Win?
                        -   “Native code permutations”
                            [\[Tully\]](#rabbitref-Tully)
                        -   Weird asm, such as “stack machine working in
                            reverse polish notation”.
                        -   Metamorphism
                            [\[Strehovsky\]](#rabbitref-Strehovsky) can
                            be used at this level.
                        -   NB: using exotic instructions (such as x64
                            BCD operations: DAS/AAS/…) is controversial
                            (as they’re not used anywhere else – they
                            shout “I’m obfuscated”, so probably better
                            to avoid). \_rotl etc. is less exotic, but
                            its benefits for obfuscation are still not
                            really obvious.
                        -   Push ss/pop ss (see above)
                        -   REP &lt;some op&gt; (see above, via
                            asm \_\_emit)
                    -   compiler-dependent: GCC attributes+pragmas
                        (TODO, NOT recommended)
            -   Obfuscating Data
                -   <span
                    class="rabbit-pullquote-right-outer rabbit-pullquote-top-p"><img src="Outline%20for%20Chapter%20on%20Bot%20Fighting%20and%20Anti%20Reverse%20Engineering%20-%20IT%20Hare%20on%20Soft.ware_files/BB_emotion_0009b.png" alt="Judging hare:" class="rabbit-pullquote-img rabbit-pullquote-left-right" width="170" height="170" /><span
                    class="rabbit-pullquote-right-inner"><span
                    class="rabbit-pullquote-quote">“</span>On importance
                    of obfuscating data</span></span>On importance of
                    obfuscating data
                    -   Example: iterating 1-100 directly, and in A\*C+B
                        mod 2^32 space
                    -   Disrupt obvious relations; “white noise” data
                    -   Make information “hey, 1<sup>st</sup> byte in
                        message is its type” useless.
                -   Obfuscating variables of basic types:
                    -   Integers, strings, pointers(!)
                        -   obf&lt;&gt; template, OBF() macro (the
                            latter – ONLY for
                            strictly-intra-process stuff).
                        -   Handling ints without size spec:
                            [\[kennytm@stackoverflow\]](#rabbitref-kennytm@stackoverflow)
                    -   “Honey pots”
                    -   Can be done in templates
                        ([\[NevesAraujo\]](#rabbitref-NevesAraujo), but
                        use our much more generic
                        obfuscation generators)
                    -   Still prefer codegen: add-only
                    -   Further improvement: obfuscate&lt;type,
                        performance\_effect,
                        obfuscate\_ID&gt;::read()&lt;instance\_ID&gt;;
                        instance\_ID causes
                        equivalent-but-different-at-asm-level reads.
                    -   Representations enabling “shortcut” operations
                        (without reverting back)
                        -   Examples: A\*X+B mod 2^32, variable-radix no
                            ‘\*’, non-standard-radix
                            -   Examples for obfuscating timing
                                protection such as
                                (end-start)&gt;MAX\_DELAY
                                || (end-start)==0.
                        -   Depending on the nature of operations
                            -   Implementation is usually more difficult
                                – need to know operations for specific
                                instance (Clang).
                            -   Example: ++ by adding an odd constant
                                mod 2^n, == by direct comparison with
                                pre-calculated constant. Barely readable
                                at almost-zero cost.
                            -   Even less readable: ++ as multiplication
                                in GF(3^n), == by direct comparison with
                                pre-calculated constant. No chance in
                                hell to find out in advance when the
                                loop will stop.
            -   Replace RTTI =&gt; virtual functions, disable RTTI in
                options
            -   Obfuscating heap: ASLR (if you do your own (Re)Actor
                allocator – randomize yourself; keeping determinism in
                this case)
            -   Obfuscating call stack
                -   Trampolines (elaborated ones such as those in
                    [\[Newger\]](#rabbitref-Newger))
                    -   No exceptions over trampolines
                    -   Using nanomites (INT3-based jumps
                        [\[Tully\]](#rabbitref-Tully)) for function
                        calls
                -   keeping stacks as shallow as possible
                    -   (Re)Actors
                        -   More (Re)Actors; Logic
                            (Re)Actor-&gt;Protocol-Level Obfuscator
                            (Re)Actor -&gt;TLS (Re)Actor -&gt;post-TLS
                            obfuscation (Re)Actor -&gt;Socket (Re)Actor.
                            Good luck tracing it under time constraints
                            (especially when obfuscated queues are
                            involved – see below).
                    -   Using obfuscated&lt;int,1234&gt; etc. as call
                        parameters – helps quite a bit.
            -   Obfuscate objects(!)
                -   TODO: describe
                -   <span
                    class="rabbit-pullquote-right-outer rabbit-pullquote-top-p"><img src="Outline%20for%20Chapter%20on%20Bot%20Fighting%20and%20Anti%20Reverse%20Engineering%20-%20IT%20Hare%20on%20Soft.ware_files/BB_emotion_0027b.png" alt="Wtf hare:" class="rabbit-pullquote-img rabbit-pullquote-left-right" width="170" height="170" /><span
                    class="rabbit-pullquote-right-inner"><span
                    class="rabbit-pullquote-quote">“</span>obfuscation
                    of VMT pointer</span></span>Including obfuscation of
                    VMT pointer (preventing related attacks from
                    [\[SabanalYason\]](#rabbitref-SabanalYason))
                -   If PRNG-based – salt (to avoid identical VMT
                    pointers being identical after OBF); pointer as salt
                    (implies “have to reobf on move”).
                -   Can avoid salt if using block-cipher-like constructs
                    at least for first 16 (better 32) bytes.
                -   Partial deobf for field access (using LFSR O(1)
                    or equivalent). LCG (pre-calculated coeffs(!))
                -   For a good measure: make sure to throw in a
                    different OBF of p itself.
                -   Whether it is worth the trouble – depends, but is a
                    valid technique.
            -   Randomized data obfuscation (different representations
                of the same data on each run)
                -   sync between ends (both for values and for messages)
                -   encoded into message
            -   Hiding leaf in the forest
                -   Fake VMT pointers. TODO: best-way-to-copy
                -   Fake RTTI (simulating
                    [\[SabanalYason\]](#rabbitref-SabanalYason)).
                -   Using generated asm with registers such as
                    ecx/eax widely.
        -   Obfuscating code
            -   Obfuscating literals: integers, pointers(!), strings(!!)
                -   Have to do *much *better than
                    [\[Haephrati\]](#rabbitref-Haephrati) (key-based,
                    single enc/dec functions easy to locate and disable)
                -   Codegen: TODO: check if is it possible to avoid
                    modifying codegen for string literals
                -   Beware: literals have MUCH higher risk of being
                    optimized out than variables. In general, have to
                    add some non-guaranteed-to-be-constant stuff to be
                    sure…
                -   Kinda-steganography (lowering entropy, but not only)
                    -   hiding within existing images, example:
                        [\[xifeng27@github\]](#rabbitref-xifeng27@github)
                    -   hiding within existing text:
                        [\[Ubuntu\]](#rabbitref-Ubuntu), DON’T use “as
                        is” (even with password)
                        -   adding pointless html (&lt;div&gt; etc.).
                            NOT “CSS-based hiding” such as invisible
                            text, navy-on-black, etc.!
                    -   hiding within *generated *text
                        (redundancy, injection).
                        [\[Salomon\]](#rabbitref-Salomon)
                        -   Funny stuff: pulling silly text from a
                            facebook etc. page. Not really usable “as
                            is” &lt;sad-face /&gt;
                    -   wierd: code redundancy, example:
                        [\[El-Khalil\]](#rabbitref-El-Khalil)
            -   Force-inlining
                -   <span
                    class="rabbit-pullquote-right-outer rabbit-pullquote-top-p"><img src="Outline%20for%20Chapter%20on%20Bot%20Fighting%20and%20Anti%20Reverse%20Engineering%20-%20IT%20Hare%20on%20Soft.ware_files/BB_emotion_0017b.png" alt="Arguing hare:" class="rabbit-pullquote-img rabbit-pullquote-left-right" width="170" height="170" /><span
                    class="rabbit-pullquote-right-inner"><span
                    class="rabbit-pullquote-quote">“</span>Force-inlining
                    as a prerequisite for serious
                    obfuscation</span></span>Prerequisite for serious
                    obfuscation
                -   Discussion on out-of-order optimizations =&gt;
                    interleaving =&gt; “shaking” signatures etc.
                    -   What if we have 50% of the code obfuscated?
                        80%?
                        Proverbial “needle in a haystack”. Will it break
                        currently-existing signature-based techniques
                        completely? There exists amount of white noise
                        which makes signal extraction impossible.
                -   Force-inline obfuscators!!
                -   Force-inline (custom) allocations and
                    constructors/destructors! (preventing search for
                    constructors/destructors from
                    [\[SabanalYason\]](#rabbitref-SabanalYason))
                -   Side bonus: defeat “There are many code
                    cross-references to a function” heuristic
                    from [\[RaabeBallenthin\]](#rabbitref-RaabeBallenthin)
            -   Compile-time polymorphism
                -   Achieved automagically by using LOTS of random
                    force-inlined obfuscators
                    -   Explain optimization mechanics.
                    -   Other stuff (see below)
            -   Changing default calling convention (\_\_thiscall
                for MSVC) into \_\_fastcall, \_\_cdecl, or \_\_stdcall.
                Helps against ECX-reliant techniques such as those in
                [\[SabanalYason\]](#rabbitref-SabanalYason). Don’t know
                to change it globally (/Gd,/Gr, and /Gz won’t work for
                member functions), but specifying \_\_fastcall etc. for
                the function itself is supposed to work. RANDOMCALL
                macro modifier.
            -   Kinda-VMs (example: P-Code from
                [\[Newger\]](#rabbitref-Newger))
            -   asm, such as [\[Lyashko\]](#rabbitref-Lyashko). NB: I’d
                rather have it added (and randomized!) by a
                Src-2-Src compiler.
        -   Obfuscating messages
            -   Intra-Client only for the time being
            -   Special attention: MsgIDs
            -   Obfuscating streams (can be made stateful).
            -   Instance\_ID still applies
        -   Massive Source-Level Obfuscation
            -   Looks as Declarative-ONLY at programmer level (=”no
                obfuscation code in app-level code, only
                ‘please-obfuscate’ declarations”)
            -   Variables/literals/messages/… as described above
            -   Literally hundreds of places in code
            -   Automated obfuscator re-generation for each build
            -   Benefits large programs the most (making this technique
                not that useful for malicious programs)
        -   Obfuscating Code+Data (data via removing VMT
            pointers): templates+inlines(!).
            -   <span
                class="rabbit-pullquote-right-outer rabbit-pullquote-top-p"><img src="Outline%20for%20Chapter%20on%20Bot%20Fighting%20and%20Anti%20Reverse%20Engineering%20-%20IT%20Hare%20on%20Soft.ware_files/BB_emotion_0025b.png" alt="Hare wondering if you are crazy:" class="rabbit-pullquote-img rabbit-pullquote-left-right" width="170" height="170" /><span
                class="rabbit-pullquote-right-inner"><span
                class="rabbit-pullquote-quote">“</span>replacing virtual
                functions with a template.</span></span>replacing
                virtual functions with a template. Two cases for dynamic
                dispatch: (a) real collections of polymorphic objects
                (real dynamic dispatch, cannot easily replace with a
                template); (b) type is known, virtual function used as
                abstraction (static dispatch is enough, can be replaced
                with template). Example: Reactor::react().

            <!-- -->

            -   Obfuscating communication between different modules
                -   IDL
                -   Obfuscated queues (arbitrary switch to another queue
                    &lt;he-he /&gt;). Don’t forget to force-inline queue
                    functions and to obfuscate pointers within(!!).
                -   Obfuscation can be applied both to function calls,
                    or (even better) messages (works very well
                    with (Re)Actors).
                -   Real key exchange (RSA, Diffie-Hellman – but can be
                    MUCH smaller than usual, such as 64-bit).
            -   Self-modifying code:
                -   Hurts static analysis
                -   Change constants on the fly
                    -   C++ (function
                        pointer-&gt;find constant-&gt;replace)
                    -   JS/emscripten [\[Elliot\]](#rabbitref-Elliot)
                    -   emscripten: can use *both*
                -   Change code on the fly
                    -   C++: have to know
                        what-it-is-likely-to-compile-into (or to use asm
                        in source code). Example with embedding
                        RDTSC check.
                -   Beware: conflicts with integrity checks
                -   Beware: page protection, anti-virus false positives.
        -   Generalization to other languages
            -   TBH – obfuscation-wise C++ rulezz… (whether C is better,
                is an open question; if C++ avoids RTTI and VMT
                pointers, it IS better – due to XYZ)
            -   TODO: IL2CPP
            -   Variable/class names (usual source-level obfuscation)
            -   Along the same lines as C++: literals (TODO:check
                details), variables (TODO:check details), messages,
                (Re)Actors
                -   Avoiding optimizing out can be limited (ref above)
            -   Force-Inlines, templates-which-clone-code: by Src-2-Src
                compiler &lt;ouch! /&gt;
            -   TODO
        -   Src-2-Src compile:
            -   Additional Obfuscations:
                -   Compile-time polymorphism:
                    -   random inlines/force-inlines
                    -   Shuffling functions/data definitions,
                        struct/class fields, order of files in make
                    -   Adding junk code
                        [\[CodeMorph\]](#rabbitref-CodeMorph),
                        [\[StarForce\]](#rabbitref-StarForce) – not too
                        useful (randomized data obfuscation is
                        *much *better).
                    -   Function substitution
                        [\[Wójcik\]](#rabbitref-Wójcik)
                    -   Randomizing asm-level patterns (along the lines
                        of [\[Lyashko\]](#rabbitref-Lyashko) and
                        [\[Bremer\]](#rabbitref-Bremer))
                    -   “Table interpretation”
                        [\[Eilam\]](#rabbitref-Eilam), chapter 10
                -   Trampolines [\[Newger\]](#rabbitref-Newger)
                -   Nanomites [\[Tully\]](#rabbitref-Tully), example in
                    [\[drew77@rohitab\]](#rabbitref-drew77@rohitab)
                -   TODO: more?
            -   <span
                class="rabbit-pullquote-right-outer rabbit-pullquote-top-p"><img src="Outline%20for%20Chapter%20on%20Bot%20Fighting%20and%20Anti%20Reverse%20Engineering%20-%20IT%20Hare%20on%20Soft.ware_files/BB_emotion_0010b.png" alt="Inquisitive hare:" class="rabbit-pullquote-img rabbit-pullquote-left-right" width="170" height="170" /><span
                class="rabbit-pullquote-right-inner"><span
                class="rabbit-pullquote-quote">“</span>Implementing
                src-2-src compiler based on
                Clang</span></span>Implementation: using clang to modify
                code: public example of doing *some* modifications
                [\[ariel19@github\]](#rabbitref-ariel19@github) (use
                ONLY as an example of “how to use clang to modify
                source code”). TODO: more examples
        -   Beyond source code
            -   Binary code obfuscation (see, for example,
                [\[yellowbyte@github\]](#rabbitref-yellowbyte@github))
                -   Metamorphism
                -   “native code permutations”
                    [\[Tully\]](#rabbitref-Tully)
                -   Implementation:
                    -   binary post-processing (latter – available as
                        3<sup>rd</sup>-party TODO:find/list; Armadillo
                        is interesting because of interplay with source
                        code [\[Kotik\]](#rabbitref-Kotik));
                    -   Using LLVM to modify LLVM bytecode
                        [\[Merlini\]](#rabbitref-Merlini)
            -   Custom compiler
                -   Holy grail, but huuuuge headache.
                    -   Even with custom compiler, source-code-level
                        stuff is necessary.
                -   Custom/obfuscated stack frames
                -   Custom/obfuscated calling conventions (dealing with
                    ecx/eax conventions and related analysis from
                    [\[SabanalYason\]](#rabbitref-SabanalYason))
                -   Custom/obfuscated VMT pointers
                -   Anti-disassembling techniques such as jump within
                    instruction (see also p.144 in \[Antivirus
                    Hacker’s Handbook\])
                -   MAY also include all the source-level obfuscation
                    generation (though it still needs to be marked in
                    source to understand performance implications)
                -   Implementation: Clang (now also works for MSVC)
        -   Obfuscating distributed messages/protocols. Versioning
            -   Intra-Client – trivial to re-generate each time
            -   Server-2-Server – not about bot fighting, but does help
                with security; not too difficult as long as we restart
                everything at once (patches are ok via re-using
                obfuscators); if necessary versioning is possible
                and simple.
            -   Client-2-Server – a Major Headache, but Extremely Useful
                -   MUST-have: blocking older versions(!!)
                    -   Simplistic “check protocol version” won’t fly
                        (single point of attack) =&gt; have to spread it
                        over the code.
                -   IDL-Based Versioning
                -   Single-Client-Multiple-Servers
                -   Backward Compatibility
                    -   Format-Converting Front-End Servers (code
                        generated by versioned IDL; ability to turn off
                        quickly if necessary; more quarantine etc.)
        -   Dynamic protection
            -   Area of active research (=”your guess is as good
                as mine”)
            -   Server-Side online hacking detection (time-based)
                -   Keys from Server-Side to decrypt certain logic (can
                    be decrypting *wrong* logic &lt;evil-grin /&gt;)
                    -   Implementing decryption on Windows
                        -   [\[Lyashko2\]](#rabbitref-Lyashko2)
                        -   Linker-map based
                        -   Our-own-DLL+custom loader (DON’T create DLL
                            in file system – load it directly instead)
                            -   DO “sign” DLLs (actually – still
                                obfuscation, as subject to self-MITM,
                                but a rather good one)
                            -   Own loader:
                                [\[pasztorpisti@codeproject\]](#rabbitref-pasztorpisti@codeproject)
                                can improve things *greatly* (but beware
                                of false AV positives)
                            -   obfuscating DLL calls (see, for example,
                                [\[Wardman\]](#rabbitref-Wardman))
                        -   Loading real code (see above re. kinda-DLL).
                            Example: critical payment stuff for
                            free accounts.
                            -   Whole (Re)Actors *with different
                                obfuscation*
                            -   1000 different versions of obfuscation
                                loaded on-demand (with check on
                                server-side that client matches
                                whatever-version-he-was-given).
                                &lt;very-evil-grin /&gt;
            -   Server-controlled honey pots
                -   Normally – valid non-obfuscated copy of the data
                    (“accidentally left there” &lt;grin /&gt;). When
                    suspecting this player – a flag is sent to
                    modify/remove it, so the bot will stop working (and
                    you’ll be able to see that play has stopped, or that
                    player started to play worse all of a sudden)
                -   <span
                    class="rabbit-pullquote-right-outer rabbit-pullquote-top-p"><img src="Outline%20for%20Chapter%20on%20Bot%20Fighting%20and%20Anti%20Reverse%20Engineering%20-%20IT%20Hare%20on%20Soft.ware_files/BB_emotion_0023b.png" alt="Hare with an idea:" class="rabbit-pullquote-img rabbit-pullquote-left-right" width="170" height="170" /><span
                    class="rabbit-pullquote-right-inner"><span
                    class="rabbit-pullquote-quote">“</span>if you feel
                    *really* evil – you can make the honey pot data look
                    plausible, so the bot will make things *worse* for
                    the bot-aided player</span></span>if you feel
                    *really* evil – you can make the data look
                    plausible, so the bot will make things *worse* for
                    the bot-aided player.
                -   About the same is possible for protocols (messages
                    carrying two copies of some vital data – one
                    encrypted, and another unencrypted, normally the
                    same but sometimes…).
            -   Deterministic redundant information in
                Client-&gt;Server packets. Example: player clicks etc.
                (usual for Authoritative Server), *plus* (ID of network
                packets received, some piece of state), sufficient to
                reconstruct the state on the Server-Side relying
                on determinism.
                -   Specialized (Re)Actor (or part of (Re)Actor) for
                    this purpose (with obfuscation etc.)
                    -   Make sure to mix in obfuscated messages and
                        state fields
                    -   Cascading information from previous (Re)actors.
                    -   Acts as a “kinda-signature” for the stream
                    -   Time MAY be excluded
                -   Main (Re)Actor
                    -   Cross-platform determinism is necessary;
                        really ugly(!) as soon as floating-point is
                        involved &lt;sad-face /&gt;. Recording to run
                        checks semi-manually on the same executable is
                        still possible.
                        -   Very limited floating-point:
                            last-4-or-so-bits transferred for FP fields
                            of the state (or more-or-less linear integer
                            fields affected by FP calculations).
                    -   Time (MAY have to roughen to milliseconds since
                        previous one)
                    -   All the unacknowledged event history is sent
                        Client-&gt;Server until ack – to avoid re-sync
                    -   Re-sync happens only when state is sent from the
                        Server
                    -   More devious: request desired piece-of-state
                        from the Server-Side
                    -   Checks MAY be selective (“red flag”) to save
                        Server-Side resources; recording for semi-manual
                        checks later.
                    -   Extremely powerful (~=”ongoing integrity
                        verification”); with proper obfuscation added –
                        is likely to stand on its own for a while even
                        without system-dependent stuff =&gt; enables
                        emscripten (still, beware of floating-point)!
                        -   Still, usually doesn’t cover from certain
                            attacks such as texture replacement.
    -   What to obfuscate?
        -   -   <span
                class="rabbit-pullquote-right-outer rabbit-pullquote-top-p"><img src="Outline%20for%20Chapter%20on%20Bot%20Fighting%20and%20Anti%20Reverse%20Engineering%20-%20IT%20Hare%20on%20Soft.ware_files/BB_emotion_0040b.png" alt="Hare with " class="rabbit-pullquote-img rabbit-pullquote-left-right" width="170" height="170" /><span
                class="rabbit-pullquote-right-inner"><span
                class="rabbit-pullquote-quote">“</span>DON'T want to
                obfuscate at vertex level!</span></span>Not at vertex
                level! But it is not that much of a problem in practice.
                -   3D model level is still attackable – but MUCH less
                    performance-critical =&gt; can be obfuscated.
            -   More generally – we have to obfuscate those 95% of code
                which take 5% of execution time.

            <!-- -->

            -   Do we want to have detection/enforcement on
                Low-Risk-for-hacking games?
                -   Disabling protection for such players/games.
                -   Going further – use server-driven code
                    decryption/loading to hide such code completely.

    -   Will it help?
        -   If you want to hide your Client-Side intellectual property
            this way – probably not.
            -   For MOGs with Authoritative Servers – most of IP is
                Server-Side anyway.
        -   Economics: cost of maintaining obfuscated code on our side
            &lt;&lt; costs of breaking every 2 weeks
            -   <span
                class="rabbit-pullquote-right-outer rabbit-pullquote-top-p"><img src="Outline%20for%20Chapter%20on%20Bot%20Fighting%20and%20Anti%20Reverse%20Engineering%20-%20IT%20Hare%20on%20Soft.ware_files/BB_emotion_0008b.png" alt="Hare pointing out:" class="rabbit-pullquote-img rabbit-pullquote-left-right" width="170" height="170" /><span
                class="rabbit-pullquote-right-inner"><span
                class="rabbit-pullquote-quote">“</span>Reverse
                engineering is an “inverse problem”, and inverse
                problems are generally *more difficult* than forward
                ones</span></span>Reverse engineering is an “inverse
                problem” \[TODO: wikiquote\], and inverse problems are
                generally *more difficult* than forward ones
        -   If we want to protect integrity of our game universe, the
            best we can hope for – is engaging into
            new-armor-resists-old-shell – new-shell-beats-old-armor
            battle (instead of giving up).
            -   Armor-vs-Shell arms race. Do we really want to abandon
                all the armor just because no perfect armor exists?
        -   Advice above will probably help, but only for some time.
            -   Temporary competitive advantage is very likely (also
                “you don’t need to run faster than the bear”).
            -   Both theoretical (such as differential analysis) and
                implementation flaws may exist =&gt; be ready to adjust.
    -   False positives by AV
        -   Heuristic Engines. TODO: elaborate
            [\[Schmall\]](#rabbitref-Schmall),
            [\[Balci\]](#rabbitref-Balci),
            [\[F-Secure\]](#rabbitref-F-Secure);
            list: [\[Balci\]](#rabbitref-Balci)
            -   Scary stuff (but doesn’t materialize in practice):
                anti-reverse-engineering===malicious
                [\[Antwerp\]](#rabbitref-Antwerp)
            -   Detecting decryption loop
                [\[ZhangEtAl\]](#rabbitref-ZhangEtAl),
                [\[Szor\]](#rabbitref-Szor),
                [\[SabanalYason\]](#rabbitref-SabanalYason)
                -   non-zeroing XOR
                    [\[RaabeBallenthin\]](#rabbitref-RaabeBallenthin).
                    Ok, with obfuscation we can use ADD &lt;wink /&gt;.
                -   Avoiding decryption loop: unrolling+recursion (won’t
                    last but…)
            -   Undocumented APIs (don’t use)
            -   Guarded memory regions (jury is out on this one…)
            -   Rumored: “suspicious” function calls (LoadLibrary(),
                GetProcAddress(), VirtualAllocEx()) – IMO cannot
                be *too *bad…
            -   Internet/socket APIs,”potential IP address in
                memory” (MIGHT be better to obfuscate)
            -   PE manipulations (SizeOfImage, entry point
                manipulations, section
                manipulations) [\[F-Secure\]](#rabbitref-F-Secure) – to
                be avoided
            -   Entropy increase
                -   per-function code obfuscation
                -   extreme case: kinda-steganography
            -   Non-issues: killing antivirus processes, injections,
                elevating privileges, modifying proxy settings, sleeping
                for a looong while (just DON’T do it)
            -   Potential conflicts with detection: querying process
                information (hide?), installing hooks \[\[TODO: more\]
            -   Quasi-issues: dropping executable files (MAY be needed
                for upgrading – but from what I’ve seen, AVs are smart
                enough to see the manifest)
        -   TODO: IEEE Taggant (TODO: is it really honored by AVs?)
        -   Grade our approaches \[static code obfuscation, data
            obfuscation, and RDTSC is ‘low’, obfuscating pointers and
            obfuscating calls to OS is ‘medium’, code encryption and
            manipulation is ‘high’\]. Exception: emscripten &lt;smile
            /&gt;

        <!-- -->

        -   Comparison Table for Different Techniques (Platforms,
            Effect, false positive risks).

-   **Overall Bot Fighting Efforts**
    -   Bot Fighting Team
        -   Inserting obfuscation into existing code
            -   Testing, more testing and even more testing. We don’t
                want to jeopardize obfuscating effort by crashing the
                whole thing. OTOH – will help to find well-hidden bugs
                (and bad practices, such as messing with memory) in
                non-obfuscated code.
            -   Testing against AV engines.
        -   Monitor public and not-so-public forums (the latter will
            require infiltrating them) where attacks-on-your-system are
            discussed, so you can adjust and counter-act. Let attackers
            play whack-a-mole.
        -   Reverse engineering existing attacks
    -   Unknown Attacks – as discussed above
    -   Complaints – analysis tools required. Deterministic stuff(!).
    -   Known Attacks
        -   <span
            class="rabbit-pullquote-right-outer rabbit-pullquote-top-p"><img src="Outline%20for%20Chapter%20on%20Bot%20Fighting%20and%20Anti%20Reverse%20Engineering%20-%20IT%20Hare%20on%20Soft.ware_files/BB_emotion_0028b.png" alt="Swearing hare:" class="rabbit-pullquote-img rabbit-pullquote-left-right" width="170" height="170" /><span
            class="rabbit-pullquote-right-inner"><span
            class="rabbit-pullquote-quote">“</span>Monitor and Obtain
            known attacks (including infiltration of
            private forums)</span></span>Monitor and Obtain (including
            infiltration of private forums)
        -   Analyze
        -   Fight Back
-   **Summary**
    -   The best we can – is to engage attacker into arms war
        -   At the moment, we’re behind. Doesn’t mean it is hopeless.
            -   “Given time, everything can be broken” =&gt; we should
                not give time
        -   Most of attacks rely on data, while 99% of protections don’t
            even try to protect data.
    -   Need to spend LOTS of time on it. Special bot fighting team
        (often known as Security Team, which is a misnomer).
        -   Systemic efforts. Just adding one “protection” won’t help.
            Weakest link principle, but every bit counts.
        -   MUST use basic precautions (including channel encryption to
            avoid self-MITM)
        -   <span
            class="rabbit-pullquote-right-outer rabbit-pullquote-top-p"><img src="Outline%20for%20Chapter%20on%20Bot%20Fighting%20and%20Anti%20Reverse%20Engineering%20-%20IT%20Hare%20on%20Soft.ware_files/BB_emotion_0009b.png" alt="Judging hare:" class="rabbit-pullquote-img rabbit-pullquote-left-right" width="170" height="170" /><span
            class="rabbit-pullquote-right-inner"><span
            class="rabbit-pullquote-quote">“</span>MUST make
            source-level effort to obfuscate</span></span>MUST make
            source-level effort to obfuscate (most of the time DIY, in
            theory can be assisted by 3<sup>rd</sup>-party libs and
            tools; Armadillo example)
            -   MUST be limited to non-semantic-changing actions such as
                replacing int with OBF(int,OBFFAST), and
                adding FORCEINLINE.
                -   Changes such as replacing ‘&lt;’ with ‘!=’ for upper
                    bound of the loop, MIGHT be considered as
                    semantically-equivalent, BUT still require
                    extreme care.
            -   MUST be massive (and expanding)
            -   MUST use randomized codegen (template-based
                implementation *might* be ok, as long as it is still
                pseudo-randomized on a truly random seed generated at
                build time).
            -   MUST obfuscate protocols, both intra-Client and
                Client-2-Server (for Client-2-Server versioning is a
                headache, but is worth the trouble).
        -   SHOULD use system-level protection (DIY or
            3<sup>rd</sup>-party).
            -   SHOULD be integrated with source-level effort.
            -   SHOULD include some kind of “encryption” (actually
                – scrambling).
            -   Beware of AV false positives.
        -   MUST have Server-Side statistics with “red flags”
        -   MUST have a way (tools+processes+team) to manually analyse
            player complaints and automated “red flags”
        -   MUST monitor published/commercial attacks on your game and
            issue updates.

\[\[TODO: interactions with (Re)Actors replays – both as an attack
vector and as a way to prove innocence for player\]\]

\[\[To Be Continued…
--------------------

<span
class="rabbit-pullquote-left-outer rabbit-pullquote-top-p"><img src="Outline%20for%20Chapter%20on%20Bot%20Fighting%20and%20Anti%20Reverse%20Engineering%20-%20IT%20Hare%20on%20Soft.ware_files/BB_emotionM_0001b.png" alt="Tired hare:" class="rabbit-pullquote-img rabbit-pullquote-left-left" width="170" height="170" /><span
class="rabbit-pullquote-left-inner"></span></span>Phew. With just an
*outline* being over 5000 words, this is going to be a *huge*
chapter. I’ll get to the substance of it a few weeks later.

Meanwhile, stay tuned for further parts of Chapter 27, where we’ll
continue our discussion on DB optimizations (going into the strange
field of app-level caches and app-level replicas)\]\]

<span class="rabbit-nowrap">Don't like this
post? **<a href="#rabbit-comment" class="rabbit-share-text-link">Comment↯ below</a>**.</span>
<span class="rabbit-nowrap">You do?! Please share:
<a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=http%3A%2F%2Fithare.com%2Foutline-for-chapter-on-bot-fighting-and-anti-reverse-engineering%2F&amp;title=Outline+for+Chapter+on+Bot+Fighting+and+Anti+Reverse+Engineering&amp;summary=" class="pop"><img src="Outline%20for%20Chapter%20on%20Bot%20Fighting%20and%20Anti%20Reverse%20Engineering%20-%20IT%20Hare%20on%20Soft.ware_files/socialnet_linkedin.png" title="Spill Some Sarcasm over LinkedIn" alt="...on LinkedIn" width="26" height="26" /></a><a href="http://reddit.com/submit?url=http%3A%2F%2Fithare.com%2Foutline-for-chapter-on-bot-fighting-and-anti-reverse-engineering%2F&amp;title=Outline+for+chapter+on+bot+fighting+and+anti+reverse+engineering" class="pop"><img src="Outline%20for%20Chapter%20on%20Bot%20Fighting%20and%20Anti%20Reverse%20Engineering%20-%20IT%20Hare%20on%20Soft.ware_files/socialnet_reddit1.png" title="Stir Controversy on Reddit" alt="...on Reddit" width="26" height="26" /></a><a href="http://twitter.com/share?url=http%3A%2F%2Fithare.com%2Foutline-for-chapter-on-bot-fighting-and-anti-reverse-engineering%2F&amp;text=" class="pop"><img src="Outline%20for%20Chapter%20on%20Bot%20Fighting%20and%20Anti%20Reverse%20Engineering%20-%20IT%20Hare%20on%20Soft.ware_files/socialnet_twitter1.png" title="Put your 140 characters worth on Twitter" alt="...on Twitter" width="26" height="26" /></a><a href="http://www.facebook.com/sharer.php?u=http%3A%2F%2Fithare.com%2Foutline-for-chapter-on-bot-fighting-and-anti-reverse-engineering%2F" class="pop"><img src="Outline%20for%20Chapter%20on%20Bot%20Fighting%20and%20Anti%20Reverse%20Engineering%20-%20IT%20Hare%20on%20Soft.ware_files/socialnet_facebook.png" title="Share Ingenuity (or not) on Facebook" alt="...on Facebook" width="26" height="26" /></a></span>

### <span class="rabbit-expand-references" style="cursor:pointer;">\[<span>+</span>\]</span>References

[]()\[Carpenter\] Nicole Carpenter, [“Riot awarded $10 million in League
of Legends scripting
lawsuit”](https://dotesports.com/league-of-legends/riot-games-wins-10-million-payout-on-league-of-legends-lawsuit-5006)

[]()\[Mansoor\] Saqib Mansoor, [“Another League of Legends Script
Provider Banned by Riot
Games”](https://segmentnext.com/2017/05/24/another-league-of-legends-script-provider-banned-by-riot-games/)

[]()\[Dodd\] Gavin Dodd, [“Keeping the Pirates at
Bay”](https://www.gamasutra.com/view/feature/3030/keeping_the_pirates_at_bay.php)

[]()\[nihilus@github\] nihilus@github,
[“ScyllaHide”](https://github.com/nihilus/ScyllaHide)

[]()\[mrexodia@github\] mrexodia@github,
[“TitanHide”](https://github.com/mrexodia/TitanHide)

[]()\[mausy131\] mausy131, [“How to use an AntiDebugger Protection in
C++ (Prove in OllyDbg) HD”](https://www.youtube.com/watch?v=mOUPOkJoseE)

[]()\[SabanalYason\] Paul Vincent Sabanal, Mark Vincent Yason,
[“Reversing
C++”](https://www.blackhat.com/presentations/bh-dc-07/Sabanal_Yason/Paper/bh-dc-07-Sabanal_Yason-WP.pdf)

[]()\[Aiko\] Kenji Aiko, [“New reverse engineering technique using API
hooking and sysenter hooking, andcapturing of cash card
access”](https://www.blackhat.com/presentations/bh-jp-08/bh-jp-08-Aiko/bh-jp-08-Aiko-EN.pdf)

[]()\[Balci\] Ege Balci, [“Art of Anti Detection –
1”](https://pentest.blog/art-of-anti-detection-1-introduction-to-av-detection-techniques/)

[]()\[Schneier\] Bruce Schneier, [“Class
Breaks”](https://www.schneier.com/blog/archives/2017/01/class_breaks.html)

[]()\[Falliere\] Nicolas Falliere, [“Windows Anti-Debug
Reference”](https://www.symantec.com/connect/articles/windows-anti-debug-reference)

[]()\[pedram\] pedram, [“Obfuscated
RDTSC”](http://www.openrce.org/reference_library/anti_reversing_view/28/Obfuscated%20RDTSC/)

[]()\[Antony@StackOverflow\] Antony@StackOverflow, [“How do browsers
pause/change Javascript when tab or window is not
active?”](https://stackoverflow.com/a/16033979/4947867)

[]()\[Kulchytskyy\] Oleg Kulchytskyy, [“Anti Debugging Protection
Techniques With
Examples”](https://www.apriorit.com/dev-blog/367-anti-reverse-engineering-protection-techniques-to-use-before-releasing-software)

[]()\[BiondiDesclaux\] Philippe Biondi, Fabrice Desclaux, [“Silver
Needle in the
Skype”](http://www.blackhat.com/presentations/bh-europe-06/bh-eu-06-biondi/bh-eu-06-biondi-up.pdf)

[]()\[Ferrie\] Peter Ferrie, [“The 'Ultimate' Anti-Debugging
Reference”](http://anti-reversing.com/Downloads/Anti-Reversing/The_Ultimate_Anti-Reversing_Reference.pdf)

[]()\[LordNoteworthy@github\] LordNoteworthy@github, [“Anti
Debug”](https://github.com/LordNoteworthy/al-khaser/tree/master/al-khaser/Anti%20Debug)

[]()\[zer0fl4g@github\] zer0fl4g@github,
[“DebugDetector”](https://github.com/zer0fl4g/DebugDetector)

[]()\[NTInsider\] The NT Insider, [“Exceptional Behavior - x64
Structured Exception
Handling”](http://www.osronline.com/article.cfm?article=469)

[]()\[OpenRCE\] OpenRCE, [“OpenRCE Anti Reverse Engineering Techniques
Database”](http://www.openrce.org/reference_library/anti_reversing)

[]()\[Tully\] Joshua Tully, [“An Anti-Reverse Engineering
Guide”](https://www.codeproject.com/Articles/30815/An-Anti-Reverse-Engineering-Guide)

[]()\[pasztorpisti@codeproject\] pasztorpisti@codeproject, [“Loading
Win32/64 DLLs 'manually' without
LoadLibrary()”](https://www.codeproject.com/Tips/430684/Loading-Win-DLLs-manually-without-LoadLibrary)

[]()\[Wardman\] CraigWardman, [“Finding the address of
GetProcAddress”](http://www.craigwardman.com/Blogging/BlogEntry/finding-the-address-of-getprocaddress)

[]()\[Elliot\] Ian Elliot, [“Javascript Jems - Self Modifying
Code”](http://www.i-programmer.info/programming/javascript/989-javascript-jems-self-modifying-code.html)

[]()\[Torrey\] Jacob I. Torrey, [“HARES: Hardened Anti-Reverse
Engineering System”](https://jacobtorrey.com/HARES-WP.pdf)

[]()\[Wójcik\] Bartosz Wójcik, [“Anti reverse engineering. Malware vs
Antivirus
Software”](https://www.pelock.com/articles/anti-reverse-engineering-malware-vs-antivirus-software)

[]()\[Baines\] Jacob Baines, [“Programming Linux Anti-Reversing
Techniques”](http://leanpub.com/anti-reverse-engineering-linux)

[]()\[Hare.1\] 'No Bugs' Hare, [“Advocating “Obscurity Pockets” as a
Complement to Security. Part I. Definition and
Benefits.”](http://ithare.com/advocating-obscurity-pockets-as-a-complement-to-security-part-i-definition-and-benefits/)

[]()\[Hare.3\] 'No Bugs' Hare, [“Advocating “Obscurity Pockets” Part
III. Code Obfuscation
Basics.”](http://ithare.com/advocating-obscurity-part-iii-code-obfuscation-basics/)

[]()\[Whiteboxcrypto\] [“WBC: protecting cryptographic keys in software
applications”](http://www.whiteboxcrypto.com/)

[]()\[XuEtAl\] Dongpeng Xu, Jiang Ming, Dinghao Wu, [“Cryptographic
Function Detection in Obfuscated Binaries via Bit-precise Symbolic Loop
Mapping”](https://faculty.ist.psu.edu/wu/papers/CryptoHunt.pdf)

[]()\[IvanchykhinEtAl\] Dmytro Ivanchykhin, Sergey Ignatchenko, Daniel
Lemire, [“Regular and almost universal hashing: an efficient
implementation”](http://onlinelibrary.wiley.com/doi/10.1002/spe.2461/abstract)

[]()\[Dawson\] Bruce Dawson, [“Floating-Point
Determinism”](https://randomascii.wordpress.com/2013/07/16/floating-point-determinism/)

[]()\[Bertrand\] Michael Bertrand, [“The CORDIC Method for Faster sin
and cos
Calculations”](http://www.drdobbs.com/the-cordic-method-for-faster-sin-and-cos/184402614)

[]()\[Chou\] Allen Chou, [“Game Math: Approximation with Polynomial
Curves”](http://allenchou.net/2014/02/game-math-approximation-with-polynomial-curves/)

[]()\[zfedoran@stackoverflow\] zfedoran@stackoverflow, [“Is there a
faster sine function?”](https://gamedev.stackexchange.com/a/4780/77056)

[]()\[porgarmingduod@stackoverflow\] porgarmingduod@stackoverflow, [“C++
library for integer trigonometry, speed optimized with optional
approximations?”](https://stackoverflow.com/questions/8182939/c-library-for-integer-trigonometry-speed-optimized-with-optional-approximatio)

[]()\[Epp@stackoverflow\] Dietrich Epp@stackoverflow, [“How to prevent
gcc optimizing some statements in
C?”](https://stackoverflow.com/a/2219839/4947867)

[]()\[Keil\] [“Compiler optimization and the volatile
keyword”](http://www.keil.com/support/man/docs/armcc/armcc_chr1359124222941.htm)

[]()\[Regehr\] John Regehr, [“Nine ways to break your systems code using
volatile”](https://blog.regehr.org/archives/28)

[]()\[jrmymllr\] jrmymllr, [“Preventing GCC from optimizing out
variable”](https://embdev.net/topic/157425)

[]()\[Strehovsky\] Michal Strehovsky, [“Advanced self-modifying
code”](http://migeel.sk/blog/2007/08/02/advanced-self-modifying-code/)

[]()\[kennytm@stackoverflow\] kennytm@stackoverflow, [“template
specialization according to sizeof
type”](https://stackoverflow.com/a/3529334/4947867)

[]()\[NevesAraujo\] Samuel Neves, Filipe Araujo, [“Binary code
obfuscation through C++ template
metaprogramming”](https://www.cisuc.uc.pt/publication/show/3134)

[]()\[Newger\] Jan Newger, [“Anti-RE Techniques in DRM
Code”](https://www.defcon.org/images/defcon-16/dc16-presentations/newger/defcon-16-newger-wp.pdf)

[]()\[Haephrati\] Michael Haephrati, [“Strings Obfuscation
System”](https://www.codeproject.com/Articles/502283/Strings-Obfuscation-System)

[]()\[Lyashko\] Alexey Lyashko, [“Basics of Executable Code
Obfuscation”](http://syprog.blogspot.com/2012/02/basics-of-executable-code-obfuscation.html)

[]()\[drew77@rohitab\] drew77@rohitab, [“Understanding of this
anti-debug
method”](http://www.rohitab.com/discuss/topic/39869-understanding-of-this-anti-debug-method/)

[]()\[ariel19@github\] ariel19@github,
[“dDeflect”](https://github.com/ariel19/Thesis/tree/master/dDeflect)

[]()\[yellowbyte@github\] yellowbyte@github, [“Reverse Engineering
Cheatsheet”](https://github.com/yellowbyte/reverse-engineering-journal#-anti-disassembly-111716-)

[]()\[Kotik\] Anton Kotik, [“Nanomite and Debug Blocker Technologies:
Scheme, Pros, and
Cons”](https://www.apriorit.com/white-papers/293-nanomite-technology)

[]()\[Merlini\] Adrien Merlini, [“Turning Regular Code Into Atrocities
With
LLVM”](https://blog.quarkslab.com/turning-regular-code-into-atrocities-with-llvm.html)

[]()\[Lyashko2\] Alexey Lyashko, [“Dynamic Code Encryption as an Anti
Dump and Anti Reverse Engineering
measure”](http://syprog.blogspot.com/2012/03/dynamic-code-encryption-as-anti-dump.html)

[]()\[Schmall\] Markus Schmall, [“Heuristic Techniques in AV Solutions:
An
Overview”](https://www.symantec.com/connect/articles/heuristic-techniques-av-solutions-overview)

[]()\[ZhangEtAl\] Qinghua Zhang, Douglas S. Reeves, Peng Ning, S.
Purushothaman Iyer, [“Analyzing Network Traffic To Detect
Self-Decrypting Exploit
Code”](https://discovery.csc.ncsu.edu/pubs/ASIACCS07a.pdf)

[]()\[Szor\] Peter Szor, [“Advanced Code Evolution Techniques and
Computer Virus Generator
Kits”](http://www.informit.com/articles/article.aspx?p=366890&seqNum=3)

[]()\[CodeMorph\] [“CodeMorph C/C++ Code
Obfuscator”](http://www.sourceformat.com/code-obfuscator-cpp.htm)

[]()\[StarForce\] [“StarForce C++
Obfuscator”](http://www.star-force.com/products/starforce-obfuscator/)

[]()\[Bremer\] [“Abusing Forced Inline in
C”](https://jbremer.org/abusing-forced-inline-in-c/)

[]()\[Eilam\] Eldad Eilam, “Reversing: Secrets of Reverse Engineering”

[]()\[MachinesCanThink\] Machines Can Think, [“UPX Packing and
Anti-Packing
Techniques”](https://bsodtutorials.wordpress.com/2014/11/14/upx-packing-and-anti-packing-techniques/)

[]()\[F-Secure\] F-Secure, [“Malware Analysis and Antivirus
Technologies: Antivirus Engine
Basics”](http://www.cse.tkk.fi/fi/opinnot/T-110.6220/2011_Spring_Malware_Analysis_and_Antivirus_Technologies/luennot-files/av%20engines.pdf)

[]()\[RaabeBallenthin\] Moritz Raabe, William Ballenthin,
[“Automatically Extracting Obfuscated Strings from Malware using the
FireEye Labs Obfuscated String Solver
(FLOSS)”](https://www.fireeye.com/blog/threat-research/2016/06/automatically-extracting-obfuscated-strings.html)

[]()\[LestringantEtAl\] Pierre Lestringant, Frédéric Guihéry,
Pierre-Alain Fouque, [“Automated Identification of Cryptographic
Primitives in Binary Code with Data Flow Graph
Isomorphism”](https://www.amossys.fr/upload/asiaccs15_Automated_Identification_Of_Cryptographic_Primitives_In_Binary_Code_With_Data_Flow_Graph_Isomorphism_paper.pdf)

[]()\[Calvet\] Joan Calvet, [“Cryptographic Function Identification in
Obfuscated Binary
Programs”](http://2012.hackitoergosum.org/blog/wp-content/uploads/2012/04/HES-2012-jcalvet-CryptoFunctionIdentification.pdf)

[]()\[El-Khalil\] Rakan El-Khalil, <http://crazyboy.com/hydan/>

[]()\[xifeng27@github\] xifeng27@github,
[“Binary-String-Steganography”](https://github.com/xifeng27/Binary-String-Steganography)

[]()\[Ubuntu\] [“stegsnow - whitespace steganography
program”](http://manpages.ubuntu.com/manpages/zesty/man1/stegsnow.1.html)

[]()\[Salomon\] David Salomon, “Data Privacy and Security”, Chapter 10

[]()\[Cannell\] Joshua Cannell, [“Five Anti-Analysis Tricks That
Sometimes Fool
Analysts”](https://blog.malwarebytes.com/threat-analysis/2014/09/five-anti-debugging-tricks-that-sometimes-fool-analysts/)

[]()\[Hogle\] Sean Hogle, [“The absolute best anti-reverse engineering
clause I've ever
seen”](https://www.linkedin.com/pulse/20141006013553-2411722-the-absolute-best-anti-reverse-engineering-clause-i-ve-ever-seen)

[]()\[Riddle\] Rachelle Riddle, [“The Bitter Legal Battle Between
Blizzard and Bossland: Six Years In Court Over Bots And
Cheats”](https://nowloading.co/p/the-legal-battle-between-blizzard-and-bossland-over-bots-and-cheats/4240236)

[]()\[Antwerp\] Ryan Van Antwerp, [“Using the presence of
anti-reverse-engineering artifacts to detect
malware”](https://search.proquest.com/openview/4e2e9fa53e9153042125e4b803be01ef/1?pq-origsite=gscholar&cbl=18750&diss=y)

### Acknowledgement

Cartoons by Sergey
Gordeev<sup>[<img src="Outline%20for%20Chapter%20on%20Bot%20Fighting%20and%20Anti%20Reverse%20Engineering%20-%20IT%20Hare%20on%20Soft.ware_files/irl-link.png" alt="IRL" width="16" height="16" />](http://ithare.com/real-people-behind-the-hare#sergey-gordeev)</sup>
from [Gordeev Animation Graphics](http://gagltd.eu/), Prague.

**<span class="rabbit-prevnextpost-element"
style="width:4%;">« </span><span class="rabbit-prevnextpost-element"
style="text-overflow:ellipsis; width:92%;">[\#CPPCON2017 Day 0: IMO best
posters](http://ithare.com/cppcon2017-day-0-imo-best-posters/)</span> **

** <span class="rabbit-prevnextpost-element"
style="text-overflow:ellipsis; width:92%;">[\#CPPCON2017. Day 1. Hope to
get
something-better-than-chevron-hell](http://ithare.com/cppcon2017-day-1-hope-to-get-something-better-than-chevrone-hell/)</span><span
class="rabbit-prevnextpost-element" style="width:4%;"> »</span>**

<span class="entry-categories">Filed Under:
[Announcements](http://ithare.com/category/announcements/), [D&D of
MOGs: Vol. VII-IX (1st
beta)](http://ithare.com/category/dnd-of-mogs/dd-of-mogs-part-depl-1st-beta/),
[Development & Deployment of Multiplayer Online
Games](http://ithare.com/category/dnd-of-mogs/)</span>

### Related posts

<a href="http://ithare.com/merits-of-anti-reverse-engineering-for-mogs/" class="yarpp-thumbnail" title="Merits of Anti-Reverse-Engineering for MOGs"><img src="Outline%20for%20Chapter%20on%20Bot%20Fighting%20and%20Anti%20Reverse%20Engineering%20-%20IT%20Hare%20on%20Soft.ware_files/BB_part174_BookChapter29a_v2-120x120.png" class="attachment-yarpp-thumbnail size-yarpp-thumbnail wp-post-image" sizes="(max-width: 120px) 100vw, 120px" srcset="http://ithare.com/wp-content/uploads/BB_part174_BookChapter29a_v2-120x120.png 120w, http://ithare.com/wp-content/uploads/BB_part174_BookChapter29a_v2-150x150.png 150w" width="120" height="120" /><span class="yarpp-thumbnail-title">Merits of Anti-Reverse-Engineering for MOGs</span></a>
<a href="http://ithare.com/bot-fighting-102-system-specific-kinda-protection-anti-debugger-anti-dll-injection-vm-detection/" class="yarpp-thumbnail" title="Bot Fighting 102: System-Specific Kinda-Protection. Anti-Debugger, Anti-DLL-Injection, VM Detection."><img src="Outline%20for%20Chapter%20on%20Bot%20Fighting%20and%20Anti%20Reverse%20Engineering%20-%20IT%20Hare%20on%20Soft.ware_files/BB_part178_BookChapter29d_v2-120x120.png" class="attachment-yarpp-thumbnail size-yarpp-thumbnail wp-post-image" sizes="(max-width: 120px) 100vw, 120px" srcset="http://ithare.com/wp-content/uploads/BB_part178_BookChapter29d_v2-120x120.png 120w, http://ithare.com/wp-content/uploads/BB_part178_BookChapter29d_v2-150x150.png 150w" width="120" height="120" /><span class="yarpp-thumbnail-title">Bot Fighting 102: System-Specific Kinda-Protection. Anti-Debugger, Anti-DLL-Injection, VM Detection.</span></a>
<a href="http://ithare.com/bot-fighting-201-part-2-obfuscating-literals/" class="yarpp-thumbnail" title="Bot Fighting 201, Part 2: Obfuscating Literals"><img src="Outline%20for%20Chapter%20on%20Bot%20Fighting%20and%20Anti%20Reverse%20Engineering%20-%20IT%20Hare%20on%20Soft.ware_files/BB_part181_BookChapter29g_v2-120x120.png" class="attachment-yarpp-thumbnail size-yarpp-thumbnail wp-post-image" sizes="(max-width: 120px) 100vw, 120px" srcset="http://ithare.com/wp-content/uploads/BB_part181_BookChapter29g_v2-120x120.png 120w, http://ithare.com/wp-content/uploads/BB_part181_BookChapter29g_v2-150x150.png 150w" width="120" height="120" /><span class="yarpp-thumbnail-title">Bot Fighting 201, Part 2: Obfuscating Literals</span></a>
<a href="http://ithare.com/chapter-vb-modular-architecture-client-side-programming-languages-for-games-including-resilience-to-reverse-engineering-and-portability/" class="yarpp-thumbnail" title="Client-Side. Programming Languages for Games, including Resilience to Reverse Engineering and Portability"><img src="Outline%20for%20Chapter%20on%20Bot%20Fighting%20and%20Anti%20Reverse%20Engineering%20-%20IT%20Hare%20on%20Soft.ware_files/BB_part067_BookChapter005b_v2b-120x120.png" class="attachment-yarpp-thumbnail size-yarpp-thumbnail wp-post-image" sizes="(max-width: 120px) 100vw, 120px" srcset="http://ithare.com/wp-content/uploads/BB_part067_BookChapter005b_v2b-120x120.png 120w, http://ithare.com/wp-content/uploads/BB_part067_BookChapter005b_v2b-150x150.png 150w" width="120" height="120" /><span class="yarpp-thumbnail-title">Client-Side. Programming Languages for Games, including Resilience to Reverse Engineering and Portability</span></a>
<a href="http://ithare.com/bot-fighting-201-declarative-datacode-obfuscation-with-build-time-polymorphism-in-c/" class="yarpp-thumbnail" title="Bot Fighting 201: Declarative Data+Code Obfuscation with Build-Time Polymorphism in C++"><img src="Outline%20for%20Chapter%20on%20Bot%20Fighting%20and%20Anti%20Reverse%20Engineering%20-%20IT%20Hare%20on%20Soft.ware_files/BB_part180_BookChapter29f_v10-120x120.png" class="attachment-yarpp-thumbnail size-yarpp-thumbnail wp-post-image" sizes="(max-width: 120px) 100vw, 120px" srcset="http://ithare.com/wp-content/uploads/BB_part180_BookChapter29f_v10-120x120.png 120w, http://ithare.com/wp-content/uploads/BB_part180_BookChapter29f_v10-150x150.png 150w" width="120" height="120" /><span class="yarpp-thumbnail-title">Bot Fighting 201: Declarative Data+Code Obfuscation with Build-Time Polymorphism in C++</span></a>

Join our mailing list:

-

    [ITHare (0)](#discussion-main)

[]()
### Leave a Reply <a href="http://ithare.com/outline-for-chapter-on-bot-fighting-and-anti-reverse-engineering/#respond" id="cancel-comment-reply-link">Cancel reply</a>

<span id="email-notes">Your email address will not be published.</span>
Required fields are marked <span class="required">\*</span>

Comment
Name <span class="required">\*</span>

Email <span class="required">\*</span>

